<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>WindowsBatch | 李大玄-web</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="个人笔记">
    
    <link rel="preload" href="/vuePress-web-view/assets/css/0.styles.c2718638.css" as="style"><link rel="preload" href="/vuePress-web-view/assets/js/app.e2c12251.js" as="script"><link rel="preload" href="/vuePress-web-view/assets/js/2.d261dd2c.js" as="script"><link rel="preload" href="/vuePress-web-view/assets/js/210.1bb356dc.js" as="script"><link rel="prefetch" href="/vuePress-web-view/assets/js/10.a48ae725.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/100.c7b11742.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/101.81c51e56.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/102.e7a8f196.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/103.cde477ae.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/104.1d928df5.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/105.f01323dc.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/106.2ada4e5e.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/107.856bb762.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/108.a93588b0.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/109.fd5f5757.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/11.cbf20793.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/110.6afcdbcf.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/111.fb4e09b3.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/112.4934d28a.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/113.77bce6d8.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/114.6255ad43.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/115.ea5182be.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/116.c1ecf28f.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/117.9f09f544.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/118.4e09df30.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/119.28913ba5.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/12.8b9ac65f.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/120.b9e16f5e.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/121.8e57f85b.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/122.5dd78923.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/123.8cd39635.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/124.22271bb2.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/125.44c4cca3.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/126.1698ab99.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/127.678cf749.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/128.188c70c2.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/129.5139fab0.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/13.3d1c7cb5.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/130.cf2294dc.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/131.1c4caec5.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/132.bce8cf33.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/133.7016b962.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/134.2b76bdbe.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/135.0d341d17.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/136.f42a374e.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/137.c7c7affb.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/138.eabe9b27.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/139.c451aeaf.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/14.86f2f353.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/140.6acb4293.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/141.1a3e216a.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/142.e30c9a52.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/143.8ab0172c.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/144.b7b03637.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/145.8a72c912.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/146.b22af8cb.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/147.5c7e57b2.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/148.ae8008a9.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/149.92c2c8df.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/15.04b20ea8.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/150.93b84e29.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/151.82ded173.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/152.7cb0aa94.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/153.f653702f.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/154.19502074.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/155.a6006567.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/156.06cbe63c.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/157.1fd74dac.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/158.8fd0797d.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/159.e34a6e25.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/16.4d906dbd.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/160.3a464fa1.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/161.aa1b4e9f.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/162.b57b7077.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/163.a5013819.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/164.19815c8b.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/165.cd2be262.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/166.ea9dd1b0.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/167.648d0a28.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/168.04b5afd9.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/169.f174c2d0.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/17.ce4e9e1d.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/170.bca759d8.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/171.2d33cace.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/172.ea05c604.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/173.935380c9.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/174.fc362143.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/175.e37f291e.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/176.11258c25.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/177.a754a990.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/178.fb0dfd12.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/179.3140fdb1.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/18.fb5e1663.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/180.2dcf7dd3.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/181.cc32acf4.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/182.0dd9d46c.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/183.db9bb28f.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/184.79b93166.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/185.bcdb4aa4.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/186.48710590.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/187.0629f938.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/188.8c859246.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/189.a8762166.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/19.b80a2534.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/190.b2126d92.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/191.c89de971.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/192.e9dcf3b1.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/193.f962d205.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/194.527ec8cc.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/195.a01808fc.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/196.ac383372.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/197.8ab74597.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/198.1fcb2012.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/199.8fb793a7.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/20.69249846.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/200.6892fa98.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/201.68d02e94.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/202.a0135787.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/203.9d1abfae.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/204.c3d3f2d6.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/205.c16b671d.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/206.295e64c6.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/207.7ed80c8b.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/208.a2d0925d.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/209.0822aa2d.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/21.37bbe25c.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/211.7e723976.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/212.96b08048.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/213.98fe69b5.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/214.090698e9.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/215.3770359d.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/216.6d747031.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/217.2883609a.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/218.01db28a9.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/219.16a28653.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/22.aff597b3.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/220.0fac63d5.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/221.aa49087f.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/222.37eeca10.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/223.bbf611e7.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/224.b4d8cf57.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/225.84e30317.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/226.8c4c94c8.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/227.e46166d5.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/228.9fa582d5.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/229.41c96c3f.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/23.a6e85ba6.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/230.42fe58ae.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/231.29f22e36.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/232.6909d4ea.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/233.1bb5e658.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/234.ce10d276.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/235.c23b641b.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/236.805c5b9f.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/237.b7896c7d.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/238.1d85aa3c.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/239.55c686df.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/24.2bd6fcd9.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/240.8ed8a95d.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/241.93248fc5.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/242.959d8f9b.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/243.56fde1ca.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/244.17235dd6.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/245.9c96d79b.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/246.2bd6a59c.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/247.4f4a1ce9.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/248.61dc74a3.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/249.d9fbeca1.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/25.2d9a5cf9.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/250.d7f1a03d.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/251.e2e79bd0.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/252.fd82ef29.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/253.acbc4c63.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/254.c6d1ff96.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/255.dfd6076f.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/256.305be41a.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/257.a288c901.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/258.93180234.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/259.1940183b.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/26.d726f8bb.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/260.818a7777.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/261.e0410f0e.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/262.56228d9b.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/263.ce4a3070.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/264.f711119d.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/265.4f0ab0e6.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/266.bccd3f9d.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/267.af338025.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/268.e35f3cee.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/269.ec7deeb9.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/27.9ab03ced.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/270.3686c7a3.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/271.60686e38.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/272.718340d3.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/273.7ec73192.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/274.9c2d5590.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/275.802c5261.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/276.f8a6cdc8.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/277.2b9df120.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/278.5cc57928.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/279.f3f35690.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/28.ccf12eca.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/280.37eccee1.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/281.1dd9e1d4.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/282.33e0da14.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/283.b38d485a.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/284.6f4a5230.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/285.8340d592.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/286.f0269bb5.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/287.ac4c48fc.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/288.bf37e151.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/289.73731d73.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/29.798fb142.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/290.1e1d09a9.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/291.18ea342f.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/292.7cbf75b2.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/293.ade9c47c.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/294.77d5e425.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/295.4132de34.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/296.4afd2cc2.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/297.1af0cadb.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/298.9c8b833f.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/299.b1c1edbb.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/3.9195152d.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/30.84772474.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/300.ad8fd799.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/301.3aed5aee.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/31.b28dbd41.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/32.fa0cb0d1.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/33.3e29ea12.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/34.3bece125.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/35.27ba8611.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/36.a445dc21.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/37.53fd5a2e.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/38.b750b213.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/39.7eab92a9.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/4.1014300c.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/40.28fcee8e.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/41.1bab8de4.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/42.c751b36a.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/43.70d9d2bd.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/44.90112286.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/45.5b3c3bf5.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/46.26d971e2.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/47.5a3482f0.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/48.62cb6576.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/49.6452e481.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/5.bc4c35f3.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/50.25da5116.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/51.92a49557.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/52.7bcebf32.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/53.188676c0.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/54.3d99d2db.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/55.d54d2647.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/56.812bc5f2.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/57.0187da30.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/58.6ebcfe66.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/59.50cfa489.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/6.dd277a42.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/60.aa258a00.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/61.58ea42cb.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/62.d0ecc24a.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/63.741063f5.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/64.29f73438.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/65.21e0788b.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/66.0c25737b.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/67.f9777c97.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/68.35e41237.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/69.cd8dada3.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/7.d2b6f55a.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/70.c3413907.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/71.339145f8.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/72.a8364ce9.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/73.0adb6eb0.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/74.403ce97e.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/75.9c116558.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/76.8f7ac18c.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/77.d928389b.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/78.0acdc9c0.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/79.81a41959.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/8.8312b405.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/80.3a9c857a.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/81.6c43b761.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/82.98f45fbf.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/83.296a1e1d.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/84.b4dc08b8.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/85.6b9c9610.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/86.e600d412.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/87.9555fb67.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/88.e707dba1.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/89.c7b07f38.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/9.b60c2467.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/90.a7429124.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/91.98a0d3c2.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/92.aa7063d4.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/93.c447ac9d.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/94.8887558b.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/95.f7fd9a5b.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/96.344453d0.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/97.6693c9e8.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/98.ff731207.js"><link rel="prefetch" href="/vuePress-web-view/assets/js/99.b380b113.js">
    <link rel="stylesheet" href="/vuePress-web-view/assets/css/0.styles.c2718638.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuePress-web-view/" class="home-link router-link-active"><img src="https://img-blog.csdnimg.cn/211e986a4c1a41ab8e36c7d1123c9d89.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA0LzQvuS7meWgoeadoOaKiuWtkOOBlOeBrA==,size_16,color_FFFFFF,t_70,g_se,x_16#pic_center" alt="李大玄-web" class="logo"> <span class="site-name can-hide">李大玄-web</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuePress-web-view/%E3%80%8AShell%E3%80%8B%E7%AC%94%E8%AE%B0/01.前端/25.JavaScript文章/01.33个非常实用的JavaScript一行代码.html" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://google.com" target="_self" class="nav-link external">
  External
  <!----></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuePress-web-view/%E3%80%8AShell%E3%80%8B%E7%AC%94%E8%AE%B0/01.前端/25.JavaScript文章/01.33个非常实用的JavaScript一行代码.html" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://google.com" target="_self" class="nav-link external">
  External
  <!----></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>01.前端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>02.页面</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>03.技术</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>04.更多</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>05.关于</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>06.收藏夹</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>07.开发规范</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>08.vscode</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>09.语法文档</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>《ES6 教程》笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>《GO》笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>《Git》学习笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>《IDE》笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>《JavaScript教程》笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>《Java》笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>《Python》笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>《React》笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>《SQL》笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>《Shell》笔记</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuePress-web-view/《Shell》笔记/PowerShell.html" class="sidebar-link">PowerShell</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/PowerShell.html#flag" class="sidebar-link">Flag</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/PowerShell.html#包管理" class="sidebar-link">包管理</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/PowerShell.html#在batch中嵌入运行" class="sidebar-link">在batch中嵌入运行</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/PowerShell.html#windows10自带应用" class="sidebar-link">Windows10自带应用</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/PowerShell.html#命令" class="sidebar-link">命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/PowerShell.html#事件计划任务" class="sidebar-link">事件计划任务</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/PowerShell.html#常用命令" class="sidebar-link">常用命令</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/PowerShell.html#随机字符串" class="sidebar-link">随机字符串</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/PowerShell.html#http服务" class="sidebar-link">HTTP服务</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/PowerShell.html#弹窗" class="sidebar-link">弹窗</a></li></ul></li><li><a href="/vuePress-web-view/《Shell》笔记/ShellScript.html" class="sidebar-link">ShellScript</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/ShellScript.html#flag" class="sidebar-link">Flag</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/ShellScript.html#自动交互" class="sidebar-link">自动交互</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/ShellScript.html#指令有参数" class="sidebar-link">指令有参数</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/ShellScript.html#指令无参数" class="sidebar-link">指令无参数</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/ShellScript.html#清理内存" class="sidebar-link">清理内存</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/ShellScript.html#清理日志" class="sidebar-link">清理日志</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/ShellScript.html#linux之间传输文件" class="sidebar-link">Linux之间传输文件</a></li></ul></li><li><a href="/vuePress-web-view/《Shell》笔记/ShellWindows.html" class="sidebar-link">ShellWindows</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/ShellWindows.html#flag" class="sidebar-link">Flag</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/ShellWindows.html#第三方工具" class="sidebar-link">第三方工具</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/ShellWindows.html#终端复用器" class="sidebar-link">终端复用器</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/ShellWindows.html#wsl" class="sidebar-link">WSL</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/ShellWindows.html#mingw-w64" class="sidebar-link">MinGW-w64</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/ShellWindows.html#mingw-w64下载" class="sidebar-link">MinGW-w64下载</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/ShellWindows.html#mingw-w64安装" class="sidebar-link">MinGW-w64安装</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/ShellWindows.html#msys2" class="sidebar-link">MSYS2</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/ShellWindows.html#msys2命令" class="sidebar-link">MSYS2命令</a></li></ul></li></ul></li><li><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html" class="sidebar-link">Shell命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#flag" class="sidebar-link">Flag</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#查看邮箱" class="sidebar-link">查看邮箱</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#清除屏幕输出" class="sidebar-link">清除屏幕输出</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#过滤结果" class="sidebar-link">过滤结果</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#截取末尾字符串" class="sidebar-link">截取末尾字符串</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#过滤多个结果" class="sidebar-link">过滤多个结果</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#定时任务" class="sidebar-link">定时任务</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#进制转换" class="sidebar-link">进制转换</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#进程与线程" class="sidebar-link">进程与线程</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#延时" class="sidebar-link">延时</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#查找大文件" class="sidebar-link">查找大文件</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#列出目录" class="sidebar-link">列出目录</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#文件查找" class="sidebar-link">文件查找</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#批量替换文件内容" class="sidebar-link">批量替换文件内容</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#删除文件" class="sidebar-link">删除文件</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#列出文件" class="sidebar-link">列出文件</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#显示目录大小" class="sidebar-link">显示目录大小</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#查看当前路径" class="sidebar-link">查看当前路径</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#修改权限" class="sidebar-link">修改权限</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/Shell命令.html#切换目录" class="sidebar-link">切换目录</a></li></ul></li><li><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html" class="active sidebar-link">WindowsBatch</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#flag" class="sidebar-link">Flag</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#文件操作" class="sidebar-link">文件操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#获取目录名" class="sidebar-link">获取目录名</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#获取为指定后缀的文件" class="sidebar-link">获取为指定后缀的文件</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#获取不为指定后缀的文件" class="sidebar-link">获取不为指定后缀的文件</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#判断是文件还是文件夹" class="sidebar-link">判断是文件还是文件夹</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#替换文件中指定内容" class="sidebar-link">替换文件中指定内容</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#环境变量" class="sidebar-link">环境变量</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#查看环境变量" class="sidebar-link">查看环境变量</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#设置环境变量" class="sidebar-link">设置环境变量</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#ip端口dns进程" class="sidebar-link">IP端口DNS进程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#dns" class="sidebar-link">DNS</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#查看端口占用" class="sidebar-link">查看端口占用</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#查看占用的pid" class="sidebar-link">查看占用的pid</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#结束进程" class="sidebar-link">结束进程</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#延时定时事件任务" class="sidebar-link">延时定时事件任务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#任务计划" class="sidebar-link">任务计划</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#事件" class="sidebar-link">事件</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#判断字符串" class="sidebar-link">判断字符串</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#进制转换" class="sidebar-link">进制转换</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#管理员权限" class="sidebar-link">管理员权限</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#隐藏窗口运行" class="sidebar-link">隐藏窗口运行</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#刷新桌面" class="sidebar-link">刷新桌面</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#开机启动" class="sidebar-link">开机启动</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#添加注册表" class="sidebar-link">添加注册表</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#启动目录" class="sidebar-link">启动目录</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#注册表" class="sidebar-link">注册表</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#regini" class="sidebar-link">regini</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#修改" class="sidebar-link">修改</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#窗口设置" class="sidebar-link">窗口设置</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#查询" class="sidebar-link">查询</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#注册服务" class="sidebar-link">注册服务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#加入服务" class="sidebar-link">加入服务</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#删除服务" class="sidebar-link">删除服务</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsBatch.html#下载文件" class="sidebar-link">下载文件</a></li></ul></li><li><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html" class="sidebar-link">WindowsJScript</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html#flag" class="sidebar-link">Flag</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html#bat和js混合编程" class="sidebar-link">BAT和JS混合编程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html#参数传递" class="sidebar-link">参数传递</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html#activexobject" class="sidebar-link">ActiveXObject</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html#js函数封装" class="sidebar-link">js函数封装</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html#http请求" class="sidebar-link">HTTP请求</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html#解析xml" class="sidebar-link">解析XML</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html#解析html" class="sidebar-link">解析HTML</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html#图片格式转换" class="sidebar-link">图片格式转换</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html#设置壁纸" class="sidebar-link">设置壁纸</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html#刷新桌面" class="sidebar-link">刷新桌面</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html#获取系统信息" class="sidebar-link">获取系统信息</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html#解压zip" class="sidebar-link">解压zip</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html#下载7z" class="sidebar-link">下载7z</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html#数据库" class="sidebar-link">数据库</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html#开机启动" class="sidebar-link">开机启动</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html#获取所有com组件" class="sidebar-link">获取所有COM组件</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html#创建任务计划" class="sidebar-link">创建任务计划</a></li></ul></li></ul></li><li><a href="/vuePress-web-view/《Shell》笔记/WindowsScript.html" class="sidebar-link">WindowsScript</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsScript.html#flag" class="sidebar-link">Flag</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsScript.html#系统环境变量" class="sidebar-link">系统环境变量</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsScript.html#wscript对象" class="sidebar-link">WScript对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsScript.html#wscript对象的属性" class="sidebar-link">WScript对象的属性</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsScript.html#wscript对象的方法" class="sidebar-link">WScript对象的方法</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsScript.html#常用组件对象" class="sidebar-link">常用组件对象</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsScript.html#http" class="sidebar-link">HTTP</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsScript.html#图像处理" class="sidebar-link">图像处理</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsScript.html#操作文件" class="sidebar-link">操作文件</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsScript.html#shell" class="sidebar-link">Shell</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsScript.html#执行命令" class="sidebar-link">执行命令</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsScript.html#特殊文件夹" class="sidebar-link">特殊文件夹</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsScript.html#模拟按键" class="sidebar-link">模拟按键</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsScript.html#wmi和mi" class="sidebar-link">WMI和MI</a></li></ul></li><li><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html" class="sidebar-link">WindowsVBScript</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html#flag" class="sidebar-link">Flag</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html#特殊符号" class="sidebar-link">特殊符号</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html#函数封装" class="sidebar-link">函数封装</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html#自动关闭弹窗" class="sidebar-link">自动关闭弹窗</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html#数组转换为字符串" class="sidebar-link">数组转换为字符串</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html#获取对象的属性和值" class="sidebar-link">获取对象的属性和值</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html#获取系统信息" class="sidebar-link">获取系统信息</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html#隐藏窗口运行" class="sidebar-link">隐藏窗口运行</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html#查看进程是否存在" class="sidebar-link">查看进程是否存在</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html#ping" class="sidebar-link">Ping</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html#监视网络连接" class="sidebar-link">监视网络连接</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html#监视网络断开" class="sidebar-link">监视网络断开</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html#设置壁纸" class="sidebar-link">设置壁纸</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html#刷新桌面" class="sidebar-link">刷新桌面</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html#字符编码转换" class="sidebar-link">字符编码转换</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html#选择文件对话框" class="sidebar-link">选择文件对话框</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html#文件编码转换" class="sidebar-link">文件编码转换</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/WindowsVBScript.html#vba" class="sidebar-link">VBA</a></li></ul></li><li><a href="/vuePress-web-view/《Shell》笔记/首页.html" class="sidebar-link">首页</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/首页.html#flag" class="sidebar-link">Flag</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/首页.html#行尾序列" class="sidebar-link">行尾序列</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/首页.html#文件编码转换" class="sidebar-link">文件编码转换</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/首页.html#第三方ssh" class="sidebar-link">第三方SSH</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/首页.html#batch与shell同义操作符" class="sidebar-link">batch与shell同义操作符</a></li><li class="sidebar-sub-header"><a href="/vuePress-web-view/《Shell》笔记/首页.html#batch与shell同义命令" class="sidebar-link">batch与shell同义命令</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>《System》笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>《TypeScript 实现 axios》</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>《Vue》笔记</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="windowsbatch"><a href="#windowsbatch" class="header-anchor">#</a> WindowsBatch</h1> <p></p><div class="table-of-contents"><ul><li><a href="#flag">Flag</a></li><li><a href="#文件操作">文件操作</a><ul><li><a href="#获取目录名">获取目录名</a></li><li><a href="#获取为指定后缀的文件">获取为指定后缀的文件</a></li><li><a href="#获取不为指定后缀的文件">获取不为指定后缀的文件</a></li><li><a href="#判断是文件还是文件夹">判断是文件还是文件夹</a></li><li><a href="#替换文件中指定内容">替换文件中指定内容</a></li></ul></li><li><a href="#环境变量">环境变量</a><ul><li><a href="#查看环境变量">查看环境变量</a></li><li><a href="#设置环境变量">设置环境变量</a></li></ul></li><li><a href="#ip端口dns进程">IP端口DNS进程</a><ul><li><a href="#dns">DNS</a></li><li><a href="#查看端口占用">查看端口占用</a></li><li><a href="#查看占用的pid">查看占用的pid</a></li><li><a href="#结束进程">结束进程</a></li></ul></li><li><a href="#延时定时事件任务">延时定时事件任务</a><ul><li><a href="#任务计划">任务计划</a></li><li><a href="#事件">事件</a></li></ul></li><li><a href="#判断字符串">判断字符串</a></li><li><a href="#进制转换">进制转换</a></li><li><a href="#管理员权限">管理员权限</a></li><li><a href="#隐藏窗口运行">隐藏窗口运行</a></li><li><a href="#刷新桌面">刷新桌面</a></li><li><a href="#开机启动">开机启动</a><ul><li><a href="#添加注册表">添加注册表</a></li><li><a href="#启动目录">启动目录</a></li></ul></li><li><a href="#注册表">注册表</a><ul><li><a href="#regini">regini</a></li><li><a href="#修改">修改</a></li><li><a href="#窗口设置">窗口设置</a></li><li><a href="#查询">查询</a></li></ul></li><li><a href="#注册服务">注册服务</a><ul><li><a href="#加入服务">加入服务</a></li><li><a href="#删除服务">删除服务</a></li></ul></li><li><a href="#下载文件">下载文件</a></li></ul></div><p></p> <h2 id="flag"><a href="#flag" class="header-anchor">#</a> Flag</h2> <ul><li><a href="https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/windows-commands" target="_blank" rel="noopener noreferrer">Windows 命令-官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/kekec/p/3662125.html" target="_blank" rel="noopener noreferrer">windows常用命令<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/kekec/p/3937530.html" target="_blank" rel="noopener noreferrer">windows批处理语法<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.im/post/5d50c631518825378d5d6121" target="_blank" rel="noopener noreferrer">windows之四十个bat脚本命令<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://segmentfault.com/a/1190000018614430" target="_blank" rel="noopener noreferrer">windows bat脚本总结<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.thewindowsclub.com/rundll32-shortcut-commands-windows" target="_blank" rel="noopener noreferrer">Windows 10/8/7的Rundll32命令列表<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://gitlab.com/jarv/cmdchallenge" target="_blank" rel="noopener noreferrer">https://gitlab.com/jarv/cmdchallenge<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li><a href="https://cmdchallenge.com" target="_blank" rel="noopener noreferrer">https://cmdchallenge.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul> <ul><li><a href="/files/%E6%B7%BB%E5%8A%A0%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F.bat">添加快捷方式</a></li> <li><a href="/files/%E8%AE%BE%E7%BD%AE%E5%BF%85%E5%BA%94%E5%A3%81%E7%BA%B8.bat">设置必应壁纸</a></li> <li><a href="/files/%E8%AE%BE%E7%BD%AEgithub%E7%9A%84hosts.bat">设置GitHub的Hosts</a></li> <li><a href="/files/frpc.bat">frpc.bat</a> 会自动检测本地<code>fprc</code>是否为最新版本，如果不是或者没有则下载最新版</li></ul> <ul><li><code>if</code>和<code>for</code>的条件与后面跟的<code>(</code>之间必须要有一个空格，否则会出现<code>命令语法不正确</code>的问题！</li> <li>使用cd切换目录时，如果带盘符一定要加<code>/d</code>参数，否则切换无效</li> <li>双引号中包含双引号最里层的要用三个<code>&quot;&quot;&quot;</code>转义，<code>&amp;</code>符号要用<code>^</code>转义
<ul><li>示例:使用<code>curl</code>配合<code>jq</code>获取必应壁纸下载地址</li></ul></li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">curl</span> <span class="token string">&quot;http://cn.bing.com/HPImageArchive.aspx?format=js&amp;idx=0&amp;n=1&quot;</span> <span class="token operator">^</span>
 | jq-win64.exe <span class="token string">&quot;.images[0].url | &quot;&quot;&quot;</span>https://cn.bing.com<span class="token string">&quot;&quot;&quot; + .[0:index(&quot;&quot;&quot;</span><span class="token operator">^</span>&amp;<span class="token string">&quot;&quot;&quot;)]&quot;</span> &gt;&gt; bing.txt</span>
</code></pre></div><div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 解压MSI</span>
<span class="token command"><span class="token keyword">msiexec</span> <span class="token parameter attr-name">/a</span> <span class="token string">&quot;MSI文件路径&quot;</span> <span class="token parameter attr-name">/qn</span> TARGETDIR=<span class="token string">&quot;解压输出目录绝对路径&quot;</span></span>
<span class="token comment">:: 弹窗</span>
<span class="token command"><span class="token keyword">msg</span> <span class="token variable">%username%</span> <span class="token parameter attr-name">/time<span class="token punctuation">:</span></span><span class="token number">60</span> <span class="token string">&quot;WARNING:a backdoor account is created&quot;</span></span>
</code></pre></div><ul><li>Windows10当前桌面壁纸：<code>%AppData%\Microsoft\Windows\Themes\CachedFiles\CachedImage_1920_1080_POS4.jpg</code></li> <li>Windows7当前桌面壁纸：<code>%AppData%\Microsoft\Windows\Themes\TranscodedWallpaper.jpg</code></li> <li>事件日志目录：<code>%SystemRoot%\System32\Winevt\Logs</code></li></ul> <h2 id="文件操作"><a href="#文件操作" class="header-anchor">#</a> 文件操作</h2> <ul><li><a href="https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/robocopy" target="_blank" rel="noopener noreferrer">robocopy复制文件及目录结构<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 路径都为文件所在顶级文件夹</span>
<span class="token command"><span class="token keyword">robocopy</span> <span class="token parameter attr-name">/ndl</span> <span class="token parameter attr-name">/njh</span> <span class="token parameter attr-name">/njs</span> <span class="token parameter attr-name">/s</span> 源路径 目的路径 复制的文件多个以空格分隔</span>
</code></pre></div><ul><li><a href="https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/xcopy" target="_blank" rel="noopener noreferrer">xcopy复制文件及目录结构<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/forfiles" target="_blank" rel="noopener noreferrer">forfiles遍历文件夹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 列出文件，类似于linux下的ls</span>
<span class="token command"><span class="token keyword">dir</span></span>
<span class="token comment">:: 创建目录</span>
<span class="token command"><span class="token keyword">md</span> 目录名（文件夹）</span>
<span class="token comment">:: 删除目录</span>
<span class="token command"><span class="token keyword">rd</span>  目录名（文件夹）</span>
<span class="token comment">:: 拷贝文件</span>
<span class="token command"><span class="token keyword">copy</span> 路径\文件名 路径\文件名</span>
<span class="token comment">:: 移动文件</span>
<span class="token command"><span class="token keyword">move</span> 路径\文件名 路径\文件名</span>
<span class="token comment">:: 删除文件，不能删除文件夹</span>
<span class="token command"><span class="token keyword">del</span> 文件名</span>
</code></pre></div><h3 id="获取目录名"><a href="#获取目录名" class="header-anchor">#</a> 获取目录名</h3> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 顺序循环，设置最后一个为当前目录</span>
<span class="token command"><span class="token keyword">for</span> <span class="token parameter attr-name">/f</span> <span class="token string">&quot;delims=&quot;</span> <span class="token variable">%%i</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">&quot;%cd%&quot;</span><span class="token punctuation">)</span> <span class="token keyword">do</span></span> <span class="token command"><span class="token keyword">set</span> <span class="token variable">folder</span><span class="token operator">=</span><span class="token variable">%%~ni</span></span>
<span class="token command"><span class="token keyword">echo</span> <span class="token variable">%folder%</span></span>

<span class="token comment">:: 仅将 %0 扩充到一个路径</span>
<span class="token command"><span class="token keyword">set</span> <span class="token variable">currentPath</span><span class="token operator">=</span><span class="token variable">%~dp0</span></span>
<span class="token comment">:: 替换\为,号，也可以替换为空格</span>
<span class="token command"><span class="token keyword">set</span> <span class="token variable">currentPath</span><span class="token operator">=</span><span class="token variable">%currentPath:</span>\<span class="token operator">=</span><span class="token punctuation">,</span><span class="token operator">%</span></span>
<span class="token comment">:: 顺序循环，设置最后一个为当前目录</span>
<span class="token command"><span class="token keyword">for</span> <span class="token variable">%%a</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token variable">%currentPath%</span><span class="token punctuation">)</span> <span class="token keyword">do</span></span> <span class="token command"><span class="token keyword">set</span> <span class="token variable">folder</span><span class="token operator">=</span><span class="token variable">%%a</span></span>
<span class="token command"><span class="token keyword">echo</span> <span class="token variable">%folder%</span></span>
</code></pre></div><h3 id="获取为指定后缀的文件"><a href="#获取为指定后缀的文件" class="header-anchor">#</a> 获取为指定后缀的文件</h3> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">::获取为指定后缀的文件</span>
<span class="token command"><span class="token keyword">for</span> <span class="token parameter attr-name">/r</span> <span class="token variable">%~dp0</span> <span class="token variable">%%a</span> <span class="token keyword">in</span> <span class="token punctuation">(</span>*.jpg<span class="token punctuation">,</span>*.png<span class="token punctuation">)</span> <span class="token keyword">do</span></span> <span class="token punctuation">(</span>
	::把文件后缀赋值给变量
	<span class="token command"><span class="token keyword">set</span> suffix <span class="token operator">=</span> <span class="token variable">%%~xa</span></span>
	::把文件名赋值给变量（没有后缀）
	<span class="token command"><span class="token keyword">set</span> name <span class="token operator">=</span> <span class="token variable">%%~na</span></span>
	::把路径赋值给变量（不带驱动号和文件名）
	<span class="token command"><span class="token keyword">set</span> path <span class="token operator">=</span> <span class="token variable">%%~pa</span></span>
	::把驱动号赋值给变量
	<span class="token command"><span class="token keyword">set</span> drive <span class="token operator">=</span> <span class="token variable">%%~da</span></span>
	
	::判断后缀
	<span class="token command"><span class="token keyword">if</span> <span class="token parameter attr-name">/i</span> <span class="token string">&quot;!suffix!&quot;</span> <span class="token operator">neq</span> <span class="token string">&quot;.bmp&quot;</span></span> <span class="token punctuation">(</span>
		<span class="token command"><span class="token keyword">ren</span> <span class="token string">&quot;%%~a&quot;</span> <span class="token string">&quot;%%~na.bmp&quot;</span></span>
	<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre></div><div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">::获取为指定后缀的文件</span>
<span class="token command"><span class="token keyword">for</span> <span class="token parameter attr-name">/f</span> <span class="token string">&quot;delims=&quot;</span> <span class="token variable">%%i</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token punctuation">'</span>dir <span class="token parameter attr-name">/s</span> <span class="token parameter attr-name">/b</span> <span class="token parameter attr-name">/a</span>  <span class="token variable">%~dp0</span> ^| findstr <span class="token parameter attr-name">/e</span> <span class="token string">&quot;\.jpg\&gt; \.png\&gt;&quot;</span><span class="token punctuation">'</span><span class="token punctuation">)</span> <span class="token keyword">do</span></span> <span class="token punctuation">(</span>
	::把文件后缀写入文件
	<span class="token command"><span class="token keyword">echo</span> <span class="token variable">%%~dpnxi</span> &gt;&gt; test.txt</span>
<span class="token punctuation">)</span>
</code></pre></div><h3 id="获取不为指定后缀的文件"><a href="#获取不为指定后缀的文件" class="header-anchor">#</a> 获取不为指定后缀的文件</h3> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">::获取不为指定后缀的文件</span>
<span class="token command"><span class="token keyword">for</span> <span class="token parameter attr-name">/f</span> <span class="token string">&quot;delims=&quot;</span> <span class="token variable">%%i</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token punctuation">'</span>dir <span class="token parameter attr-name">/s</span> <span class="token parameter attr-name">/b</span> <span class="token parameter attr-name">/a</span>  <span class="token variable">%~dp0</span> ^| findstr <span class="token parameter attr-name">/v</span> <span class="token string">&quot;\.bat\&gt; \.text\&gt; \.exe\&gt;&quot;</span><span class="token punctuation">'</span><span class="token punctuation">)</span> <span class="token keyword">do</span></span> <span class="token punctuation">(</span>
	::把文件后缀写入文件
	<span class="token command"><span class="token keyword">echo</span> <span class="token variable">%%~dpnxi</span> &gt;&gt; test.txt</span>
<span class="token punctuation">)</span>
</code></pre></div><h3 id="判断是文件还是文件夹"><a href="#判断是文件还是文件夹" class="header-anchor">#</a> 判断是文件还是文件夹</h3> <blockquote><p>如果是文件夹，则<code>test</code>和<code>test\</code>、<code>test\.</code>、<code>test\nul</code>是等同的；
如果是文件，则<code>test</code>不等同于三者中的任何一个</p></blockquote> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">if</span> <span class="token keyword">exist</span> test\</span> <span class="token punctuation">(</span>
    <span class="token command"><span class="token keyword">echo</span> test 是文件夹</span>
<span class="token punctuation">)</span> <span class="token command"><span class="token keyword">else</span></span> <span class="token punctuation">(</span>
    <span class="token command"><span class="token keyword">echo</span> test 是文件</span>
<span class="token punctuation">)</span>
</code></pre></div><div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">dir</span> <span class="token parameter attr-name">/ad</span> test &gt;nul <span class="token number">2</span>&gt;nul </span><span class="token operator">&amp;</span><span class="token operator">&amp;</span> <span class="token punctuation">(</span>
    <span class="token command"><span class="token keyword">echo</span> test 是文件夹</span>
<span class="token punctuation">)</span> || <span class="token punctuation">(</span>
    <span class="token command"><span class="token keyword">echo</span> test 是文件</span>
<span class="token punctuation">)</span>
</code></pre></div><h3 id="替换文件中指定内容"><a href="#替换文件中指定内容" class="header-anchor">#</a> 替换文件中指定内容</h3> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span>
<span class="token comment">:: 解决把中文写入文件乱码问题（声明采用UTF-8编码），936为GBK，437为美国英语</span>
<span class="token comment">:: https://blog.csdn.net/python_class/article/details/81560470</span>
<span class="token command"><span class="token keyword">chcp</span> <span class="token number">65001</span></span>

<span class="token comment">:: 开启延迟环境变量扩展</span>
<span class="token comment">:: 解决for或if中操作变量时提示ECHO OFF问题，用!!取变量</span>
<span class="token comment">:: 解决调用jscript提示命令错误问题</span>
<span class="token command"><span class="token keyword">setlocal</span> EnableDelayedExpansion</span>

<span class="token command"><span class="token keyword">set</span> <span class="token variable">file</span><span class="token operator">=</span><span class="token variable">%~dp0nav</span>.md</span>
<span class="token comment">:: 替换文件中指定内容</span>
<span class="token punctuation">(</span>
    <span class="token command"><span class="token keyword">for</span> <span class="token parameter attr-name">/f</span> <span class="token string">&quot;tokens=*&quot;</span> <span class="token variable">%%i</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token variable">%file%</span><span class="token punctuation">)</span> <span class="token keyword">do</span></span> <span class="token punctuation">(</span>
        :: 把当前行的内容赋值到变量
        <span class="token command"><span class="token keyword">set</span> <span class="token variable">s</span><span class="token operator">=</span><span class="token variable">%%i</span></span>
        :: 不为空行时
        <span class="token command"><span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token variable">!s!</span>.<span class="token operator">==</span>.</span> <span class="token punctuation">(</span>
            :: 替换内容中的反斜杠为正斜杠
            <span class="token command"><span class="token keyword">set</span> <span class="token variable">s</span><span class="token operator">=</span><span class="token variable">!s:\=/!</span></span>
            <span class="token command"><span class="token keyword">echo</span> <span class="token variable">!s!</span></span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>&gt;%file%

<span class="token command"><span class="token keyword">goto</span> <span class="token label property">:EXIT</span></span>

<span class="token label property">:EXIT</span>
<span class="token comment">:: 结束延迟环境变量扩展和命令执行</span>
<span class="token command"><span class="token keyword">endlocal</span></span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">exit</span> <span class="token parameter attr-name">/b</span> <span class="token variable">%errorlevel%</span></span>
</code></pre></div><h2 id="环境变量"><a href="#环境变量" class="header-anchor">#</a> 环境变量</h2> <ul><li><a href="https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/set_1" target="_blank" rel="noopener noreferrer">set<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/setx" target="_blank" rel="noopener noreferrer">setx<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p><strong><code>SET</code>与<code>SETX</code>的区别</strong></p> <ul><li><code>SET</code> 用于设置临时环境变量和查看环境变量</li> <li><code>SETX</code> 用于设置用户环境变量和系统环境变量</li></ul> <blockquote><p>变量值有空格或<code>%</code>等特殊字符时必须用<code>&quot;</code>包括起来</p></blockquote> <blockquote><p><code>SETX 变量名 变量值</code> 设置用户环境变量，记录在注册表<code>HKEY_CURRENT_USER</code></p></blockquote> <blockquote><p><code>SETX /M 变量名 变量值</code> 设置系统环境变量，记录在注册表<code>HKEY_LOCAL_MACHINE</code></p></blockquote> <h3 id="查看环境变量"><a href="#查看环境变量" class="header-anchor">#</a> 查看环境变量</h3> <ul><li>查看所有环境变量</li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 在末尾输入变量名就是查询单个变量</span>
<span class="token command"><span class="token keyword">SET</span></span>
<span class="token comment">:: 或者这样查询单个环境变量</span>
<span class="token command"><span class="token keyword">ECHO</span> <span class="token variable">%PATH%</span></span>
</code></pre></div><ul><li>查看用户环境变量</li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 替换最后的*号为变量名就是查询单个变量</span>
<span class="token command"><span class="token keyword">REG</span> QUERY <span class="token string">&quot;HKCU\Environment&quot;</span> <span class="token parameter attr-name">/v</span> *</span>
</code></pre></div><ul><li>查看系统环境变量</li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 替换最后的*号为变量名就是查询单个变量</span>
<span class="token command"><span class="token keyword">REG</span> QUERY <span class="token string">&quot;HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot;</span> <span class="token parameter attr-name">/v</span> *</span>
</code></pre></div><h3 id="设置环境变量"><a href="#设置环境变量" class="header-anchor">#</a> 设置环境变量</h3> <ul><li>临时有效</li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">set</span> <span class="token variable">path</span><span class="token operator">=</span><span class="token variable">%path%</span>;D:\test</span>
</code></pre></div><ul><li>永久有效</li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">setx</span> path <span class="token string">&quot;%path%;D:\test&quot;</span></span>
<span class="token command"><span class="token keyword">setx</span> <span class="token parameter attr-name">/m</span> path <span class="token string">&quot;%path%;D:\test&quot;</span></span>
</code></pre></div><h2 id="ip端口dns进程"><a href="#ip端口dns进程" class="header-anchor">#</a> IP端口DNS进程</h2> <p><strong>查看本机ip</strong></p> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">ipconfig</span></span>
</code></pre></div><h3 id="dns"><a href="#dns" class="header-anchor">#</a> DNS</h3> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">nslookup</span> 域名</span>
</code></pre></div><p><strong>刷新DNS</strong></p> <blockquote><p><code>C:\Windows\System32\drivers\etc\hosts</code></p></blockquote> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">ipconfig</span> <span class="token parameter attr-name">/flushdns</span></span>
</code></pre></div><h3 id="查看端口占用"><a href="#查看端口占用" class="header-anchor">#</a> 查看端口占用</h3> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">netstat</span> -an | find <span class="token string">&quot;0.0.0.0:80&quot;</span></span>
</code></pre></div><h3 id="查看占用的pid"><a href="#查看占用的pid" class="header-anchor">#</a> 查看占用的pid</h3> <blockquote><p>在<code>windows</code>系统下，不能直接使用反引号执行命令，要使用<code>for</code>循环变通下，在<code>for</code>循环中使用单<code>'</code>括起来执行命令</p></blockquote> <blockquote><p>在<code>cmd</code>命令窗口中直接使用<code>for</code>循环只能使用单<code>%</code>设置变量</p> <p>而在<code>bat</code>脚本文件中只能用双<code>%%</code>设置变量</p> <p>而且在<code>for</code>循环中执行的命令带有<code>|</code>等特殊符号需要使用<code>^</code>转义</p></blockquote> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 用findstr命令搜索</span>
<span class="token command"><span class="token keyword">for</span> <span class="token parameter attr-name">/f</span> <span class="token variable">%%i</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token punctuation">'</span>tasklist ^| findstr <span class="token parameter attr-name">/i</span> <span class="token string">&quot;程序名&quot;</span><span class="token punctuation">'</span><span class="token punctuation">)</span> <span class="token keyword">do</span></span> <span class="token command"><span class="token keyword">set</span> <span class="token variable">reslut</span><span class="token operator">=</span><span class="token variable">%%i</span></span>

<span class="token comment">:: 只输出PID编号</span>
<span class="token command"><span class="token keyword">for</span> <span class="token parameter attr-name">/f</span> <span class="token string">&quot;skip=3 tokens=2&quot;</span> <span class="token variable">%a</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token punctuation">'</span>tasklist <span class="token parameter attr-name">/fi</span> <span class="token string">&quot;imagename eq 程序名*&quot;</span><span class="token punctuation">'</span><span class="token punctuation">)</span> <span class="token keyword">do</span></span> <span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> <span class="token variable">%a</span></span>
</code></pre></div><p><strong>查看被占用端口的<code>pid</code></strong></p> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">netstat</span> -ano | findstr <span class="token number">80</span></span>
</code></pre></div><h3 id="结束进程"><a href="#结束进程" class="header-anchor">#</a> 结束进程</h3> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">taskkill</span> <span class="token parameter attr-name">/pid</span> 进程号 <span class="token parameter attr-name">/f</span></span>
<span class="token command"><span class="token keyword">taskkill</span> <span class="token parameter attr-name">/f</span> <span class="token parameter attr-name">/im</span> 程序名</span>
</code></pre></div><h2 id="延时定时事件任务"><a href="#延时定时事件任务" class="header-anchor">#</a> 延时定时事件任务</h2> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 延时等待10秒</span>
<span class="token command"><span class="token keyword">choice</span> <span class="token parameter attr-name">/t</span> <span class="token number">10</span> <span class="token parameter attr-name">/d</span> y <span class="token parameter attr-name">/n</span> &gt;nul</span>
<span class="token comment">:: 延时等待10秒</span>
<span class="token command"><span class="token keyword">timeout</span> <span class="token parameter attr-name">/T</span> <span class="token number">10</span> <span class="token parameter attr-name">/NOBREAK</span></span>
<span class="token comment">:: 持续等待，直到按下任意按键，类似于pause</span>
<span class="token command"><span class="token keyword">timeout</span> <span class="token parameter attr-name">/T</span> <span class="token number">-1</span></span>
<span class="token comment">:: 持续等待，直到你按下CTRL+C按键</span>
<span class="token command"><span class="token keyword">timeout</span> <span class="token parameter attr-name">/T</span> <span class="token number">-1</span> <span class="token parameter attr-name">/NOBREAK</span></span>
</code></pre></div><h3 id="任务计划"><a href="#任务计划" class="header-anchor">#</a> 任务计划</h3> <ul><li><a href="https://www.cnblogs.com/daimaxuejia/p/12957644.html" target="_blank" rel="noopener noreferrer">Schtasks命令详解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.microsoft.com/zh-cn/windows/win32/taskschd/task-scheduler-reference" target="_blank" rel="noopener noreferrer">任务计划程序参考<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <ul><li><a href="https://github.com/dahall/TaskScheduler" target="_blank" rel="noopener noreferrer">https://github.com/dahall/TaskScheduler<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/fireeye/SharPersist" target="_blank" rel="noopener noreferrer">https://github.com/fireeye/SharPersist<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p><strong>更高级用法见<a href="/vuePress-web-view/Shell/WindowsJScript.html#创建任务计划">创建任务计划</a></strong></p> <blockquote><p>如果任务计划运行没反应，去掉<code>/RU SYSTEM</code>试试</p></blockquote> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">taskschd</span></span>
<span class="token command"><span class="token keyword">SCHTASKS</span> <span class="token parameter attr-name">/?</span> 查看帮助</span>

<span class="token comment">:: /sc 指定计划频率：MINUTE、 HOURLY、DAILY、WEEKLY、MONTHLY, ONCE, ONSTART, ONLOGON, ONIDLE, ONEVENT</span>
<span class="token command"><span class="token keyword">SCHTASKS</span> <span class="token parameter attr-name">/Create</span> <span class="token parameter attr-name">/RU</span> SYSTEM <span class="token parameter attr-name">/RL</span> Highest <span class="token parameter attr-name">/tn</span> 定时任务名 <span class="token parameter attr-name">/tr</span> <span class="token string">&quot;运行程序路径&quot;</span> <span class="token parameter attr-name">/sc</span> DAILY</span>
<span class="token comment">:: 开机自启动</span>
<span class="token command"><span class="token keyword">SCHTASKS</span> <span class="token parameter attr-name">/Create</span> <span class="token parameter attr-name">/RU</span> SYSTEM <span class="token parameter attr-name">/RL</span> Highest <span class="token parameter attr-name">/tn</span> 定时任务名 <span class="token parameter attr-name">/tr</span> <span class="token string">&quot;运行程序路径&quot;</span> <span class="token parameter attr-name">/sc</span> ONSTART</span>
<span class="token comment">:: 每天 12:30 运行</span>
<span class="token command"><span class="token keyword">schtasks</span> <span class="token parameter attr-name">/Create</span> <span class="token parameter attr-name">/RU</span> SYSTEM <span class="token parameter attr-name">/RL</span> Highest <span class="token parameter attr-name">/tn</span> 定时任务名 <span class="token parameter attr-name">/tr</span> <span class="token string">&quot;运行程序路径&quot;</span> <span class="token parameter attr-name">/sc</span> DAILY <span class="token parameter attr-name">/st</span> <span class="token number">12</span>:<span class="token number">30</span></span>
<span class="token comment">:: 一分钟执行一次</span>
<span class="token command"><span class="token keyword">schtasks</span> <span class="token parameter attr-name">/Create</span> <span class="token parameter attr-name">/RU</span> SYSTEM <span class="token parameter attr-name">/RL</span> Highest <span class="token parameter attr-name">/tn</span> 定时任务名 <span class="token parameter attr-name">/tr</span> <span class="token string">&quot;运行程序路径&quot;</span> <span class="token parameter attr-name">/sc</span> MINUTE <span class="token parameter attr-name">/mo</span> <span class="token number">1</span></span>
<span class="token comment">:: 在指定的开始日期和结束日期之间，每天 12:00 点开始到 14:00 点，每隔5分钟运行</span>
<span class="token command"><span class="token keyword">SCHTASKS</span> <span class="token parameter attr-name">/Create</span> <span class="token parameter attr-name">/RU</span> SYSTEM <span class="token parameter attr-name">/RL</span> Highest <span class="token parameter attr-name">/tn</span> 定时任务名 <span class="token parameter attr-name">/TR</span> <span class="token string">&quot;运行程序路径&quot;</span> <span class="token parameter attr-name">/SD</span> 开始日期 <span class="token parameter attr-name">/ED</span> 结束日期 <span class="token operator">^</span>
 <span class="token parameter attr-name">/ST</span> <span class="token number">12</span>:<span class="token number">00</span> <span class="token parameter attr-name">/ET</span> <span class="token number">14</span>:<span class="token number">00</span> <span class="token parameter attr-name">/SC</span> MINUTE <span class="token parameter attr-name">/MO</span> <span class="token number">5</span></span>
<span class="token comment">:: 每天 12:00 点开始到 14:00 点自动结束</span>
<span class="token command"><span class="token keyword">SCHTASKS</span> <span class="token parameter attr-name">/Create</span> <span class="token parameter attr-name">/RU</span> SYSTEM <span class="token parameter attr-name">/RL</span> Highest <span class="token parameter attr-name">/tn</span> 定时任务名 <span class="token parameter attr-name">/TR</span> <span class="token string">&quot;运行程序路径&quot;</span> <span class="token parameter attr-name">/ST</span> <span class="token number">12</span>:<span class="token number">00</span> <span class="token parameter attr-name">/ET</span> <span class="token number">14</span>:<span class="token number">00</span> <span class="token parameter attr-name">/K</span> <span class="token parameter attr-name">/SC</span> DAILY</span>
<span class="token comment">:: 将任务附加到事件上：登录成功事件，运行事件查看器</span>
<span class="token command"><span class="token keyword">SCHTASKS</span> <span class="token parameter attr-name">/Create</span> <span class="token parameter attr-name">/RU</span> SYSTEM <span class="token parameter attr-name">/RL</span> Highest <span class="token parameter attr-name">/tn</span> 定时任务名 <span class="token parameter attr-name">/TR</span> eventvwr <span class="token parameter attr-name">/SC</span> ONEVENT <span class="token parameter attr-name">/EC</span> Security <span class="token operator">^</span>
 <span class="token parameter attr-name">/MO</span> <span class="token string">&quot;*[System[Provider[@Name='Microsoft-Windows-Security-Auditing'] and EventID=4624]]&quot;</span></span>
<span class="token comment">:: 将任务附加到事件上：系统已从低功耗状态中恢复，运行事件查看器</span>
<span class="token command"><span class="token keyword">SCHTASKS</span> <span class="token parameter attr-name">/Create</span> <span class="token parameter attr-name">/RU</span> SYSTEM <span class="token parameter attr-name">/RL</span> Highest <span class="token parameter attr-name">/tn</span> 定时任务名 <span class="token parameter attr-name">/TR</span> eventvwr <span class="token parameter attr-name">/SC</span> ONEVENT <span class="token parameter attr-name">/EC</span> System <span class="token operator">^</span>
 <span class="token parameter attr-name">/MO</span> <span class="token string">&quot;*[System[Provider[@Name='Microsoft-Windows-Power-Troubleshooter'] and EventID=1]]&quot;</span></span>

<span class="token comment">:: 查询任务</span>
<span class="token command"><span class="token keyword">SCHTASKS</span> <span class="token parameter attr-name">/Query</span> <span class="token parameter attr-name">/fo</span> LIST <span class="token parameter attr-name">/v</span> <span class="token parameter attr-name">/TN</span> 任务名称</span>
<span class="token comment">:: 强制删除任务</span>
<span class="token command"><span class="token keyword">SCHTASKS</span> <span class="token parameter attr-name">/Delete</span> <span class="token parameter attr-name">/F</span> <span class="token parameter attr-name">/TN</span> 任务名称</span>
<span class="token comment">:: 手动运行任务</span>
<span class="token command"><span class="token keyword">SCHTASKS</span> <span class="token parameter attr-name">/run</span> <span class="token parameter attr-name">/TN</span> 任务名称</span>
</code></pre></div><h3 id="事件"><a href="#事件" class="header-anchor">#</a> 事件</h3> <ul><li><a href="https://docs.microsoft.com/zh-cn/windows/win32/events/windows-events" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/zh-cn/windows/win32/events/windows-events<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.microsoft.com/zh-cn/previous-versions//aa385231(v=vs.85)" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/zh-cn/previous-versions//aa385231(v=vs.85)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.microsoft.com/zh-cn/windows/win32/wes/windows-event-log" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/zh-cn/windows/win32/wes/windows-event-log<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <ul><li><code>eventvwr</code> 打开事件查看器
<ul><li>打开eventvwr -&gt; Windows 日志 -&gt; 系统 右键打开菜单 -&gt; 将所有事件另存为(E) -&gt; 选择保存类型为xml</li></ul></li> <li><code>eventcreate</code> 该命令行工具使管理员能够创建一个自定义事件 ID 和消息于某指定事件日志里。</li> <li><code>wmic ntevent /?</code> <ul><li><code>wmic ntevent list full</code> 查看所有事件日志</li></ul></li> <li><code>wmic nteventlog /?</code></li> <li><code>wevtutil.exe qe Application /c:3 /rd:true /f:text</code></li> <li><code>(get-winevent -listlog Application).providernames</code> 或者 <code>wevtutil el</code> 查看所有事件名</li> <li><code>计算机\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Publishers</code> 注册表中所有事件</li></ul> <table><thead><tr><th>事件源</th> <th>事件ID</th> <th>说明</th></tr></thead> <tbody><tr><td>Power-Troubleshooter</td> <td>1</td> <td>系统已从低功耗状态中恢复。</td></tr> <tr><td>Kernel-Power</td> <td>42</td> <td>系统正在进入睡眠状态。</td></tr> <tr><td>Kernel-Power</td> <td>105</td> <td>电源更改。</td></tr> <tr><td>Kernel-Power</td> <td>107</td> <td>系统已从睡眠状态恢复。（已进入睡眠状态）</td></tr> <tr><td>Kernel-Power</td> <td>130</td> <td>系统开机恢复</td></tr> <tr><td>Kernel-Power</td> <td>131</td> <td>系统开机恢复</td></tr> <tr><td>Kernel-General</td> <td>1</td> <td>更改系统时间</td></tr> <tr><td>Kernel-General</td> <td>24</td> <td>已刷新时区信息，退出原因为 0。当前时区偏差为 -480。</td></tr> <tr><td>EventLog</td> <td>6013</td> <td>系统启动时间为 178611 秒。</td></tr></tbody></table> <h2 id="判断字符串"><a href="#判断字符串" class="header-anchor">#</a> 判断字符串</h2> <blockquote><p>注意：在|两端不能有空格，如果有空格则会出现匹配不正确</p> <p>这里有个BUG不能取反匹配，比如用<code>[^0-9]</code>匹配不是纯数字的字符，匹配到<code>.</code>会通过</p></blockquote> <p><strong>判断是否为数字、字母</strong></p> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 判断是否为数字、字母，在|两端不能有空格</span>
<span class="token comment">:: 注意这里有个bug不能用[^0-9]取反，匹配到.会通过</span>
<span class="token command"><span class="token keyword">echo</span> <span class="token variable">%var%</span>|findstr <span class="token string">&quot;^[a-z0-9]*$&quot;</span> &gt;nul </span><span class="token operator">&amp;</span><span class="token operator">&amp;</span> <span class="token punctuation">(</span>
    <span class="token command"><span class="token keyword">ECHO</span>.</span>
    <span class="token command"><span class="token keyword">ECHO</span>.输入的：<span class="token variable">%var%</span></span>
    <span class="token command"><span class="token keyword">ECHO</span>.</span>
<span class="token punctuation">)</span> || <span class="token punctuation">(</span>
    <span class="token command"><span class="token keyword">ECHO</span>.</span>
    <span class="token command"><span class="token keyword">ECHO</span>.输入的必须为纯小写字母或数字！</span>
    <span class="token command"><span class="token keyword">ECHO</span>.</span>
<span class="token punctuation">)</span>
</code></pre></div><p><strong>判断是否为纯数字</strong></p> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 判断是否为纯数字，在|两端不能有空格</span>
<span class="token comment">:: 注意这里有个bug不能用[^0-9]取反，匹配到.会通过</span>
<span class="token command"><span class="token keyword">echo</span> <span class="token variable">%port%</span>|findstr <span class="token string">&quot;^[0-9]*$&quot;</span> &gt;nul </span><span class="token operator">&amp;</span><span class="token operator">&amp;</span> <span class="token punctuation">(</span>
    <span class="token command"><span class="token keyword">ECHO</span>.</span>
    <span class="token command"><span class="token keyword">ECHO</span>.输入的端口：<span class="token variable">%port%</span></span>
    <span class="token command"><span class="token keyword">ECHO</span>.</span>
<span class="token punctuation">)</span> || <span class="token punctuation">(</span>
    <span class="token command"><span class="token keyword">ECHO</span>.</span>
    <span class="token command"><span class="token keyword">ECHO</span>.端口必须为纯数字！</span>
    <span class="token command"><span class="token keyword">ECHO</span>.</span>
<span class="token punctuation">)</span>
</code></pre></div><p><strong>判断字符串是否包含子字符串</strong></p> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 判断变量字符串中是否包含字符串</span>
<span class="token command"><span class="token keyword">echo</span> %字符串% | findstr %子串% &gt;nul </span><span class="token operator">&amp;</span><span class="token operator">&amp;</span> <span class="token punctuation">(</span>
    <span class="token command"><span class="token keyword">echo</span> 包含</span>
<span class="token punctuation">)</span> || <span class="token punctuation">(</span>
    <span class="token command"><span class="token keyword">echo</span> 不包含</span>
<span class="token punctuation">)</span>
</code></pre></div><div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">set</span> <span class="token variable">error</span><span class="token operator">=</span><span class="token number">1</span></span>
<span class="token comment">:: 判断文件中是否包含字符串</span>
<span class="token command"><span class="token keyword">findstr</span><span class="token parameter attr-name">/i</span> <span class="token string">&quot;123&quot;</span> <span class="token number">1</span>.txt &gt;nul <span class="token number">2</span>&gt;nul</span><span class="token operator">&amp;</span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">set</span> <span class="token string">&quot;error=&quot;</span></span>
<span class="token command"><span class="token keyword">if</span> <span class="token keyword">defined</span> error</span> <span class="token punctuation">(</span>
    <span class="token command"><span class="token keyword">echo</span> 不包含</span>
<span class="token punctuation">)</span> <span class="token command"><span class="token keyword">else</span></span> <span class="token punctuation">(</span>
    <span class="token command"><span class="token keyword">echo</span> 包含</span>
<span class="token punctuation">)</span>
</code></pre></div><h2 id="进制转换"><a href="#进制转换" class="header-anchor">#</a> 进制转换</h2> <ul><li>十进制转十六进制</li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">setlocal</span> enabledelayedexpansion</span>
<span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/p</span> 十进制<span class="token operator">=</span>请输入要转换的十进制数：</span>
<span class="token command"><span class="token keyword">for</span> <span class="token parameter attr-name">/l</span> <span class="token variable">%%a</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token number">1</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">do</span></span> <span class="token punctuation">(</span>
     <span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> 余<span class="token operator">=</span>十进制<span class="token variable">%%16</span><span class="token punctuation">,</span>十进制<span class="token operator">/=</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token variable">tmp</span><span class="token operator">=</span>余<span class="token operator">+</span><span class="token number">100</span></span>
     <span class="token command"><span class="token keyword">set</span> <span class="token variable">yu</span><span class="token operator">=</span><span class="token variable">!tmp:~1!</span> <span class="token variable">!yu!</span></span>
<span class="token punctuation">)</span>
<span class="token command"><span class="token keyword">set</span> <span class="token variable">yu</span><span class="token operator">=</span><span class="token variable">%yu:00</span><span class="token operator">=</span><span class="token number">0</span><span class="token operator">%</span></span>
<span class="token command"><span class="token keyword">for</span> <span class="token variable">%%a</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span> <span class="token number">6</span> <span class="token number">7</span> <span class="token number">8</span> <span class="token number">9</span> A B C D E F<span class="token punctuation">)</span> <span class="token keyword">do</span></span> <span class="token punctuation">(</span>
     <span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> <span class="token variable">n</span><span class="token operator">+=</span><span class="token number">101</span></span>
     <span class="token command"><span class="token keyword">for</span> <span class="token variable">%%b</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token variable">!n:~-2!</span><span class="token punctuation">)</span> <span class="token keyword">do</span></span> <span class="token punctuation">(</span>
         <span class="token command"><span class="token keyword">set</span> <span class="token variable">yu</span><span class="token operator">=</span><span class="token operator">!</span>yu: <span class="token variable">%%b</span><span class="token operator">=</span> <span class="token variable">%%a</span><span class="token operator">!</span></span>
     <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token command"><span class="token keyword">echo</span> 0x<span class="token variable">%yu:</span> =%</span>
<span class="token command"><span class="token keyword">pause</span></span>
</code></pre></div><ul><li>十六进制转十进制</li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/p</span> 十六进制<span class="token operator">=</span>请输入十六进制数字：</span>
<span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> 十进制<span class="token operator">=</span>0x<span class="token operator">%</span>十六进制:<span class="token operator">*</span><span class="token variable">x</span><span class="token operator">=</span><span class="token operator">%</span></span>
<span class="token command"><span class="token keyword">echo</span> %十进制%</span>
</code></pre></div><h2 id="管理员权限"><a href="#管理员权限" class="header-anchor">#</a> 管理员权限</h2> <ul><li><p>Windows10启用管理员：快捷键<kbd>Win</kbd> + <kbd>r</kbd> 打开“运行”输入<code>gpedit.msc</code>并运行 -&gt; <code>Windows 设置</code> -&gt; <code>安全设置</code> -&gt; <code>安全选项</code></p> <ul><li>禁用：<code>用户账户控制：以管理员批准模式运行所有管理员</code></li> <li>禁用：<code>用户账户控制：用于内置管理员账户的管理员批准模式</code></li> <li>启用：<code>账户：管理员账户状态</code></li></ul></li> <li><p>判断</p></li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">md</span> <span class="token string">&quot;%~dp0$testAdmin$&quot;</span> <span class="token number">2</span>&gt;nul</span>
<span class="token command"><span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token keyword">exist</span> <span class="token string">&quot;%~dp0$testAdmin$&quot;</span></span> <span class="token punctuation">(</span>
    <span class="token command"><span class="token keyword">echo</span> 不具备所在目录的写入权限! &gt;</span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">2</span></span>
    <span class="token command"><span class="token keyword">exit</span> <span class="token parameter attr-name">/b</span> <span class="token number">1</span></span>
<span class="token punctuation">)</span> <span class="token command"><span class="token keyword">else</span></span> <span class="token command"><span class="token keyword">rd</span> <span class="token string">&quot;%~dp0$testAdmin$&quot;</span></span>
</code></pre></div><div class="language-batch extra-class"><pre class="language-batch"><code><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span>
<span class="token comment">:: 检查权限</span>
&gt;nul 2&gt;<span class="token operator">&amp;</span><span class="token command"><span class="token keyword">1</span> <span class="token string">&quot;%SYSTEMROOT%\system32\cacls.exe&quot;</span> <span class="token string">&quot;%SYSTEMROOT%\system32\config\system&quot;</span></span>
<span class="token comment">:: 如果没有管理员权限，就请求管理权限</span>
<span class="token command"><span class="token keyword">if</span> '%<span class="token keyword">errorlevel</span>%' <span class="token operator">NEQ</span> '<span class="token number">0</span>'</span> <span class="token punctuation">(</span>
    <span class="token command"><span class="token keyword">echo</span> 不具备所在目录的写入权限! &gt;</span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">2</span></span>
    <span class="token command"><span class="token keyword">exit</span> <span class="token parameter attr-name">/b</span> <span class="token number">1</span></span>
<span class="token punctuation">)</span>
</code></pre></div><div class="language-batch extra-class"><pre class="language-batch"><code><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span>
<span class="token comment">:: 检查权限</span>
<span class="token command"><span class="token keyword">net</span> session &gt;nul <span class="token number">2</span>&gt;</span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">1</span> </span>
<span class="token command"><span class="token keyword">if</span> not <span class="token string">&quot;%errorLevel%&quot;</span> == <span class="token string">&quot;0&quot;</span> ( </span>
    <span class="token command"><span class="token keyword">echo</span> 不具备所在目录的写入权限! &gt;</span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">2</span></span>
    <span class="token command"><span class="token keyword">exit</span> <span class="token parameter attr-name">/b</span> <span class="token number">1</span></span>
<span class="token punctuation">)</span>
</code></pre></div><div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">reg</span> query HKU\S<span class="token number">-1</span><span class="token number">-5</span><span class="token number">-20</span>&gt;nul <span class="token number">2</span>&gt;nul</span>
<span class="token command"><span class="token keyword">if</span> not <span class="token string">&quot;%errorLevel%&quot;</span> == <span class="token string">&quot;0&quot;</span> ( </span>
    <span class="token command"><span class="token keyword">echo</span> 不具备所在目录的写入权限! &gt;</span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">2</span></span>
    <span class="token command"><span class="token keyword">exit</span> <span class="token parameter attr-name">/b</span> <span class="token number">1</span></span>
<span class="token punctuation">)</span>
</code></pre></div><p><strong>获取管理员权限</strong></p> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span>
<span class="token command"><span class="token keyword">fltmc</span>&gt;nul||cd<span class="token parameter attr-name">/d</span> <span class="token variable">%~dp0</span> </span><span class="token operator">&amp;</span><span class="token operator">&amp;</span> <span class="token command"><span class="token keyword">mshta</span> vbscript:CreateObject(<span class="token string">&quot;Shell.Application&quot;</span></span><span class="token punctuation">)</span>.ShellExecute<span class="token punctuation">(</span>&quot;%~nx0&quot;,&quot;%1&quot;,&quot;&quot;,&quot;runas&quot;,0<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token command"><span class="token keyword">window</span>.close</span><span class="token punctuation">)</span>

<span class="token comment">:: 下面为执行命令</span>

</code></pre></div><div class="language-batch extra-class"><pre class="language-batch"><code><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span>
<span class="token comment">::-------------------------------------------------------------------------------</span>
&gt;nul 2&gt;<span class="token operator">&amp;</span><span class="token command"><span class="token keyword">1</span> <span class="token string">&quot;%SYSTEMROOT%\system32\cacls.exe&quot;</span> <span class="token string">&quot;%SYSTEMROOT%\system32\config\system&quot;</span></span>
<span class="token command"><span class="token keyword">if</span> '%<span class="token keyword">errorlevel</span>%' <span class="token operator">NEQ</span> '<span class="token number">0</span>'</span> <span class="token punctuation">(</span> <span class="token command"><span class="token keyword">goto</span> UACPrompt </span><span class="token punctuation">)</span> <span class="token command"><span class="token keyword">else</span></span> <span class="token punctuation">(</span> <span class="token command"><span class="token keyword">goto</span> GetAdmin </span><span class="token punctuation">)</span>
<span class="token label property">:UACPrompt</span>
    ::if not &quot;%~1&quot;==&quot;&quot; set file= &quot;&quot;%~1&quot;&quot;
    ::echo CreateObject<span class="token punctuation">(</span>&quot;Shell.Application&quot;<span class="token punctuation">)</span>.ShellExecute &quot;cmd.exe&quot;, &quot;/c %~s0%file%&quot;, &quot;&quot;, &quot;runas&quot;, 0 &gt; &quot;%temp%\getadmin.vbs&quot;
    <span class="token command"><span class="token keyword">echo</span> CreateObject<span class="token operator">^</span>(<span class="token string">&quot;Shell.Application&quot;</span><span class="token operator">^</span>).ShellExecute <span class="token string">&quot;%~s0&quot;</span>, <span class="token string">&quot;%*&quot;</span>, <span class="token string">&quot;&quot;</span>, <span class="token string">&quot;runas&quot;</span>, <span class="token number">0</span> &gt; <span class="token string">&quot;%temp%\getadmin.vbs&quot;</span> </span>
    &quot;%temp%\getadmin.vbs&quot;
    <span class="token command"><span class="token keyword">exit</span> <span class="token parameter attr-name">/B</span></span>
<span class="token label property">:GetAdmin</span>
    <span class="token command"><span class="token keyword">if</span> <span class="token keyword">exist</span> <span class="token string">&quot;%temp%\getadmin.vbs&quot;</span></span> <span class="token punctuation">(</span> <span class="token command"><span class="token keyword">del</span> <span class="token string">&quot;%temp%\getadmin.vbs&quot;</span> </span><span class="token punctuation">)</span>
    <span class="token command"><span class="token keyword">pushd</span> <span class="token string">&quot;%CD%&quot;</span></span>
    <span class="token command"><span class="token keyword">CD</span> <span class="token parameter attr-name">/D</span> <span class="token string">&quot;%~dp0&quot;</span></span>
<span class="token label property">:StartCommand</span>
<span class="token comment">::-------------------------------------------------------------------------------</span>

<span class="token comment">:: 下面为执行命令</span>

</code></pre></div><h2 id="隐藏窗口运行"><a href="#隐藏窗口运行" class="header-anchor">#</a> 隐藏窗口运行</h2> <p><strong>此方式完全不会显示<code>CMD</code>窗口（包括闪现） <a href="/vuePress-web-view/Shell/WindowsScript.html#vbs函数封装">vbs脚本</a></strong></p> <p><strong>此方式会闪现<code>CMD</code>窗口 bat脚本</strong></p> <blockquote><p>如果运行的批处理名为<code>a.bat</code>，在<code>C:\</code>下，那<code>%~0</code>代表<code>C:\a.bat</code>，<code>%~nx0</code>代表<code>a.bat</code>。<code>h</code>极为参数<code>%1</code>，<code>0</code>表示隐藏运行。</p> <p>由于你双击运行，故第一次批处理<code>%1</code>为空，<code>if</code>不成立，转而运行下一句。
然后再次打开自己，并传递参数<code>h</code>，此时<code>if</code>成立，跳转至<code>begin</code>开始运行。</p></blockquote> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span>
<span class="token command"><span class="token keyword">if</span> <span class="token string">&quot;%1&quot;</span> == <span class="token string">&quot;h&quot;</span> goto begin</span>
<span class="token command"><span class="token keyword">mshta</span> vbscript:createobject(<span class="token string">&quot;wscript.shell&quot;</span></span><span class="token punctuation">)</span>.run<span class="token punctuation">(</span>&quot;%~0 h&quot;,0<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token command"><span class="token keyword">window</span>.close</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">exit</span></span>
<span class="token comment">::mshta &quot;javascript:new ActiveXObject('WScript.Shell').Run('%~0 h',0);window.close()&quot;&amp;&amp;exit</span>
<span class="token label property">:begin</span>

<span class="token comment">:: 下面为执行命令</span>

</code></pre></div><div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 静默运行软件</span>
<span class="token command"><span class="token keyword">Pushd</span> <span class="token variable">%~dp0</span></span>
<span class="token command"><span class="token keyword">start</span> <span class="token parameter attr-name">/wait</span> <span class="token parameter attr-name">/B</span> <span class="token string">&quot;&quot;</span> <span class="token string">&quot;%~dp0软件名称&quot;</span> <span class="token parameter attr-name">/S</span></span>
</code></pre></div><div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 添加开机静默启动</span>
<span class="token command"><span class="token keyword">Pushd</span> <span class="token variable">%~dp0</span></span>
<span class="token command"><span class="token keyword">start</span> <span class="token parameter attr-name">/wait</span> <span class="token parameter attr-name">/B</span> <span class="token string">&quot;&quot;</span> <span class="token string">&quot;%~dp0软件名称&quot;</span> <span class="token parameter attr-name">/ADD</span></span>
</code></pre></div><div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 删除开机静默启动</span>
<span class="token command"><span class="token keyword">Pushd</span> <span class="token variable">%~dp0</span></span>
<span class="token command"><span class="token keyword">start</span> <span class="token parameter attr-name">/wait</span> <span class="token parameter attr-name">/B</span> <span class="token string">&quot;&quot;</span> <span class="token string">&quot;%~dp0软件名称&quot;</span> <span class="token parameter attr-name">/DEL</span></span>
</code></pre></div><h2 id="刷新桌面"><a href="#刷新桌面" class="header-anchor">#</a> 刷新桌面</h2> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">REM taskkill 用户窗口被关闭</span>
<span class="token command"><span class="token keyword">taskkill</span> <span class="token parameter attr-name">/f</span> <span class="token parameter attr-name">/im</span> explorer.exe &gt;nul <span class="token number">2</span>&gt;nul</span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">start</span> explorer.exe</span>

<span class="token comment">REM regsvr32.exe 图标有白块</span>
<span class="token command"><span class="token keyword">regsvr32</span>.exe <span class="token parameter attr-name">/s</span> <span class="token parameter attr-name">/n</span> <span class="token parameter attr-name">/i<span class="token punctuation">:</span></span><span class="token parameter attr-name">/UserInstall</span> <span class="token variable">%SystemRoot%</span>\system32\themeui.dll</span>

<span class="token comment">:: 效果不太好，有时刷新成功，有时失败</span>
<span class="token command"><span class="token keyword">RunDll32</span> USER32,UpdatePerUserSystemParameters</span>

<span class="token comment">:: assoc文件关联有多余添加，可能报错，exe 类型几乎不会被修改成其他类型</span>
<span class="token command"><span class="token keyword">assoc</span> exe=exefile</span>
<span class="token comment">:: .=. 应该比较保险</span>
<span class="token command"><span class="token keyword">assoc</span> .=.</span>
</code></pre></div><ul><li>刷新桌面图标</li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span>

<span class="token comment">REM inf 代码太多</span>
&gt;%tmp%\tmp.inf <span class="token punctuation">(</span>
    <span class="token command"><span class="token keyword">echo</span>;[Version]</span>
    <span class="token command"><span class="token keyword">echo</span>;Signature=$Chicago$</span>
    <span class="token command"><span class="token keyword">echo</span>;[DefaultInstall]</span>
<span class="token punctuation">)</span>
<span class="token command"><span class="token keyword">rundll32</span> SETUPAPI.DLL,InstallHinfSection DefaultInstall <span class="token number">128</span> <span class="token variable">%tmp%</span>\tmp.inf</span>
<span class="token comment">REM inf 需要%1是有效inf，win7报错：您选中INF文件不支持此安装方法</span>
<span class="token comment">REM %SystemRoot%\System32\InfDefaultInstall.exe &quot;%1&quot;</span>
</code></pre></div><h2 id="开机启动"><a href="#开机启动" class="header-anchor">#</a> 开机启动</h2> <h3 id="添加注册表"><a href="#添加注册表" class="header-anchor">#</a> 添加注册表</h3> <blockquote><p><code>Run</code>键值代表着开机启动项，也就是说在这个项下的键值会随着开机启动
（这里的开机是指用户登录，也就是说只要有登录操作就会执行，注销然后登录，也会执行这个键值）。</p></blockquote> <blockquote><p><code>RunOnce</code>键值类似于<code>Run</code>键值，唯一的区别在于，<code>RunOnce</code>键值只执行一次，操作执行后会被自动删除。</p></blockquote> <ul><li>用户启动项</li></ul> <ol><li><code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code></li> <li><code>HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce</code></li></ol> <ul><li>本机启动项</li></ul> <ol><li><code>HKLM\SYSTEM\CurrentControlSet\Control\Session Manager</code></li> <li><code>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code></li> <li><code>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce</code></li> <li><code>HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Run</code></li> <li><code>HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\RunOnce</code></li></ol> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKCU\Software\Microsoft\Windows\CurrentVersion\Run&quot;</span> <span class="token parameter attr-name">/v</span> 软件名 <span class="token parameter attr-name">/d</span> 软件路径 <span class="token parameter attr-name">/f</span></span>
<span class="token comment">:: 或者，%号和&quot;号不能使用转移字符^转义，%号转义%%，&quot;号转义&quot;&quot;&quot;</span>
<span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKCU\Software\Microsoft\Windows\CurrentVersion\Run&quot;</span> <span class="token parameter attr-name">/v</span> 软件名 <span class="token parameter attr-name">/d</span> <span class="token string">&quot;&quot;&quot;&quot;</span>软件路径<span class="token string">&quot;&quot;&quot; /background&quot;</span> <span class="token parameter attr-name">/f</span></span>
</code></pre></div><h3 id="启动目录"><a href="#启动目录" class="header-anchor">#</a> 启动目录</h3> <blockquote><p>把软件的快捷方式或者软件直接放在以下目录中就会开机自动运行</p></blockquote> <blockquote><p>可利用<a href="/files/%E6%B7%BB%E5%8A%A0%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F.bat">脚本添加快捷方式</a>直接在启动文件夹中生成快捷方式</p></blockquote> <blockquote><p>按<code>win+r</code>打开运行窗口，输入<code>shell:startup</code>打开启动文件夹，把快捷方式或者软件放入</p></blockquote> <ul><li>Win7及以上（当前用户）: <code>%AppData%\Microsoft\Windows\Start Menu\Programs\Startup</code></li> <li>启动目录（所有用户）: <code>%ProgramData%\Microsoft\Windows\Start Menu\Programs\StartUp</code></li></ul> <h2 id="注册表"><a href="#注册表" class="header-anchor">#</a> 注册表</h2> <blockquote><p>注册表被称为Windows操作系统的核心，它的工作原理实质是一个庞大的数据库，存放了关于计算机硬件的配置信息、
系统和应用软件的初始化信息、应用软件和文档文件的关联关系、硬件设备的说明以及各种状态信息和数据，包括Windows操作时不断引用的信息。</p></blockquote> <blockquote><p>例如：系统中的硬件资源、硬件信息、分配正在使用的端口、每个用户的配置文件、计算机上安装的应用程序以及每个应用程序可以创建的文件类型等。</p></blockquote> <blockquote><p>组策略设置的实质是修改注册表中的配置</p></blockquote> <p><strong>主要作用</strong></p> <ol><li>记录安装信息</li> <li>设置硬件</li> <li>设置软件</li> <li>定制Windows</li> <li>系统安全管理</li> <li>自动运行程序</li> <li>网络设置</li></ol> <ul><li><a href="https://zhuanlan.zhihu.com/p/72194354" target="_blank" rel="noopener noreferrer">Windows注册表内容详解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://segmentfault.com/a/1190000016854021" target="_blank" rel="noopener noreferrer">简析Windows注册表<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/weiyinfu/p/10961872.html" target="_blank" rel="noopener noreferrer">windows注册表<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p><strong>注册表的分支结构</strong></p> <table><thead><tr><th>注册表短根键名</th> <th>注册表长根键名</th> <th>作用</th></tr></thead> <tbody><tr><td>HKCU</td> <td>HKEY_CURRENT_USER</td> <td>存储当前用户设置的信息。当前用户登录后才执行的操作</td></tr> <tr><td>HKLM</td> <td>HKEY_LOCAL_MACHINE</td> <td>包括安装在计算机上的硬件和软件的信息。所有操作在用户登录前就执行了</td></tr> <tr><td>HKCR</td> <td>HKEY_CLASSES_ROOT</td> <td>存储Windows可识别的文件类型的详细列表，以及相关联的程序。</td></tr> <tr><td>HKEY_USERS</td> <td>HKEY_USERS</td> <td>包含使用计算机的用户的信息。</td></tr> <tr><td>HKEY_CURRENT_CONFIG</td> <td>HKEY_CURRENT_CONFIG</td> <td>这个分支包含计算机当前的硬件配置信息。</td></tr></tbody></table> <p><strong>系统默认注册表位置</strong></p> <ul><li>为所有用户安装的程序：<code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall</code></li> <li>为当前用户安装的程序：<code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Uninstall</code></li> <li>64位系统中的32位程序：<code>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall</code></li></ul> <blockquote><p>这3个注册表总有一个包含你要找的程序，不包括UWP应用。</p></blockquote> <blockquote><p>隐藏指定的程序：在右边空白处（或左边的项名称）点击右键-&gt;新建-&gt;DWORD（32位）值，命名为<code>SystemComponent</code>，
并修改数据为<code>1</code>（新建后双击名称或右键点击选择修改，默认为<code>0</code>）。</p></blockquote> <blockquote><p>如果注册表项下面有&quot;SystemComponent&quot;字段并且值等于<code>1</code>时，表示这是个系统组件，而不是应用软件。</p></blockquote> <blockquote><p>如果注册表项下面有&quot;ParentKeyName&quot;字段则表示该项是某个分类下的子项，一般情况补丁才会有&quot;ParentKeyName&quot;字段。</p></blockquote> <h3 id="regini"><a href="#regini" class="header-anchor">#</a> regini</h3> <ul><li><a href="https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/regini" target="_blank" rel="noopener noreferrer">regini和其他所有命令官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <table><thead><tr><th>权限</th> <th>说明</th></tr></thead> <tbody><tr><td>1</td> <td>Administrators 完全访问</td></tr> <tr><td>2</td> <td>Administrators 只读访问</td></tr> <tr><td>3</td> <td>Administrators 读和写入访问</td></tr> <tr><td>4</td> <td>Administrators 读、写入、删除访问</td></tr> <tr><td>5</td> <td>Creator 完全访问</td></tr> <tr><td>6</td> <td>Creator 读和写入访问</td></tr> <tr><td>7</td> <td>everyone 完全访问</td></tr> <tr><td>8</td> <td>everyone 只读访问</td></tr> <tr><td>9</td> <td>everyone 读和写入访问</td></tr> <tr><td>10</td> <td>everyone 读、写入、删除访问</td></tr> <tr><td>11</td> <td>Power Users 完全访问</td></tr> <tr><td>12</td> <td>Power Users 读和写入访问</td></tr> <tr><td>13</td> <td>Power Users 读、写入、删除访问</td></tr> <tr><td>14</td> <td>System Operators 完全访问</td></tr> <tr><td>15</td> <td>System Operators 读和写入访问</td></tr> <tr><td>16</td> <td>System Operators 读、写入、删除访问</td></tr> <tr><td>17</td> <td>System 完全访问</td></tr> <tr><td>18</td> <td>System 读和写入访问</td></tr> <tr><td>19</td> <td>System 只读访问</td></tr> <tr><td>20</td> <td>Administrators 读、写、执行访问</td></tr> <tr><td>21</td> <td>Interactive User 完全访问</td></tr> <tr><td>22</td> <td>Interactive User 读和写入访问</td></tr> <tr><td>23</td> <td>Interactive User 读、写入、删除访问</td></tr></tbody></table> <h3 id="修改"><a href="#修改" class="header-anchor">#</a> 修改</h3> <ul><li><code>/v</code> 设置键名(value)</li> <li><code>/t</code> 设置数据类型(type)</li> <li><code>/d</code> 设置添加的值(data)</li> <li><code>/f</code> 表示强制(forbidden)</li></ul> <ul><li>删除桌面IE图标</li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">REG</span> DELETE <span class="token string">&quot;HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\{B416D21B-3B22-B6D4-BBD3-BBD452DB3D5B}&quot;</span> <span class="token parameter attr-name">/f</span></span>
</code></pre></div><ul><li>修改开机时小数字键盘不开启的问题</li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKU\.DEFAULT\Control Panel\Keyboard&quot;</span> <span class="token parameter attr-name">/v</span> InitialKeyboardIndicators <span class="token parameter attr-name">/t</span> REG_SZ <span class="token parameter attr-name">/d</span> <span class="token number">2</span> <span class="token parameter attr-name">/f</span></span>
</code></pre></div><ul><li>把图片设置为壁纸</li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKCU\Control Panel\Desktop&quot;</span> <span class="token parameter attr-name">/v</span> TileWallpaper <span class="token parameter attr-name">/d</span> <span class="token string">&quot;0&quot;</span> <span class="token parameter attr-name">/f</span> </span>
<span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKCU\Control Panel\Desktop&quot;</span> <span class="token parameter attr-name">/v</span> Wallpaper <span class="token parameter attr-name">/d</span> <span class="token string">&quot;图片绝对路径&quot;</span> <span class="token parameter attr-name">/f</span></span>
<span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKCU\Control Panel\Desktop&quot;</span> <span class="token parameter attr-name">/v</span> WallpaperStyle <span class="token parameter attr-name">/t</span> REG_DWORD <span class="token parameter attr-name">/d</span> <span class="token number">2</span> <span class="token parameter attr-name">/f</span></span>
<span class="token command"><span class="token keyword">RunDll32</span>.exe USER32.DLL,UpdatePerUserSystemParameters</span>
</code></pre></div><ul><li>开机自动运行</li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKCU\Software\Microsoft\Windows\CurrentVersion\Run&quot;</span> <span class="token parameter attr-name">/v</span> 自定义命名 <span class="token parameter attr-name">/d</span> <span class="token variable">%0</span> <span class="token parameter attr-name">/f</span></span>
</code></pre></div><ul><li>替换默认记事本</li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe&quot;</span> <span class="token operator">^</span>
 <span class="token parameter attr-name">/v</span> <span class="token string">&quot;Debugger&quot;</span> <span class="token parameter attr-name">/t</span> REG_SZ <span class="token parameter attr-name">/d</span> <span class="token string">&quot;\&quot;记事本程序路径\&quot; -z&quot;</span> <span class="token parameter attr-name">/f</span></span>
</code></pre></div><ul><li>恢复系统默认记事本</li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">REG</span> DELETE <span class="token string">&quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe&quot;</span> <span class="token parameter attr-name">/f</span></span>
<span class="token command"><span class="token keyword">REG</span> DELETE <span class="token string">&quot;HKLM\Software\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe&quot;</span> <span class="token parameter attr-name">/f</span></span>
<span class="token command"><span class="token keyword">REG</span> DELETE <span class="token string">&quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe&quot;</span> <span class="token parameter attr-name">/v</span> <span class="token string">&quot;Debugger&quot;</span> <span class="token parameter attr-name">/f</span></span>
</code></pre></div><ul><li>Windows Defender</li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 关闭“启用Windows安全中心服务”的通知</span>
<span class="token command"><span class="token keyword">REG</span> DELETE <span class="token string">&quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellServiceObjects\{F56F6FDD-AA9D-4618-A949-C1B91AF43B1A}&quot;</span> <span class="token parameter attr-name">/f</span></span>

<span class="token comment">:: 关闭Windows Defender</span>
<span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender&quot;</span> <span class="token parameter attr-name">/v</span> <span class="token string">&quot;DisableAntiSpyware&quot;</span> <span class="token parameter attr-name">/d</span> <span class="token number">1</span> <span class="token parameter attr-name">/t</span> REG_DWORD <span class="token parameter attr-name">/f</span></span>

<span class="token comment">:: 启用Windows Defender</span>
<span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender&quot;</span> <span class="token parameter attr-name">/v</span> <span class="token string">&quot;DisableAntiSpyware&quot;</span> <span class="token parameter attr-name">/d</span> <span class="token number">0</span> <span class="token parameter attr-name">/t</span> REG_DWORD <span class="token parameter attr-name">/f</span>   </span>
</code></pre></div><h3 id="窗口设置"><a href="#窗口设置" class="header-anchor">#</a> 窗口设置</h3> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">Mode</span> con cols=宽分辨率 lines=高分辨率</span>
</code></pre></div><blockquote><p>窗口大小是被改成了你想要的, 可是屏幕缓冲区的大小也变成了一样，这让你无法追溯屏幕打印的历史，
也就是说<code>mode</code>对于窗口大小和屏幕缓冲区大小不能单独设置。</p></blockquote> <blockquote><p>解决办法就是修改注册表，先要知道保存系统默认的<code>cmd</code>命令窗口的屏幕缓冲区大小的两个键值</p></blockquote> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 窗口大小</span>
<span class="token command"><span class="token keyword">HKEY_CURRENT_USER</span>\Console\ScreenBufferSize</span>

<span class="token comment">:: 屏幕缓冲区大小</span>
<span class="token command"><span class="token keyword">HKEY_CURRENT_USER</span>\Console\WindowSize</span>
</code></pre></div><blockquote><p>值是用的十六进制值来表示的，十六进制可以前加零来补齐为8位来理解</p> <p>十六进制的前四位是高，后四位是宽</p></blockquote> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 窗口高宽40*120</span>
<span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKEY_CURRENT_USER\Console&quot;</span> <span class="token parameter attr-name">/t</span> REG_DWORD <span class="token parameter attr-name">/v</span> WindowSize <span class="token parameter attr-name">/d</span> 0x00280078 <span class="token parameter attr-name">/f</span></span>
<span class="token comment">:: 屏幕缓冲区高宽1000*120</span>
<span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKEY_CURRENT_USER\Console&quot;</span> <span class="token parameter attr-name">/t</span> REG_DWORD <span class="token parameter attr-name">/v</span> ScreenBufferSize <span class="token parameter attr-name">/d</span> 0x03e80078 <span class="token parameter attr-name">/f</span></span>
</code></pre></div><h3 id="查询"><a href="#查询" class="header-anchor">#</a> 查询</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>FOR /F <span class="token string">&quot;usebackq delims==&quot;</span> %i IN <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>REG QUERY HKCU /v onedrive /s<span class="token variable">`</span></span><span class="token punctuation">)</span> DO @echo %i
</code></pre></div><h2 id="注册服务"><a href="#注册服务" class="header-anchor">#</a> 注册服务</h2> <ul><li><a href="https://www.cnblogs.com/pingming/p/5108947.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/pingming/p/5108947.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="加入服务"><a href="#加入服务" class="header-anchor">#</a> 加入服务</h3> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: 等号后面的空格必须</span>
<span class="token command"><span class="token keyword">sc</span> create 服务名称 binPath= 执行程序路径或者命令 start= auto displayname= <span class="token string">&quot;描述&quot;</span></span>
</code></pre></div><ul><li>示例</li></ul> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">sc</span> create frp内网穿透 binPath= D:\frp\frps.bat start= auto displayname= <span class="token string">&quot;frp内网穿透&quot;</span></span>

<span class="token command"><span class="token keyword">sc</span> create frp内网穿透 binPath= <span class="token string">&quot;cmd.exe /c D:\frp内网穿透工具\frpc.exe -c D:\frp内网穿透工具\frpc.ini&quot;</span> <span class="token operator">^</span>
 start= auto displayname= <span class="token string">&quot;frp内网穿透&quot;</span></span>
</code></pre></div><h3 id="删除服务"><a href="#删除服务" class="header-anchor">#</a> 删除服务</h3> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">sc</span> delete 服务名称</span>
</code></pre></div><h2 id="下载文件"><a href="#下载文件" class="header-anchor">#</a> 下载文件</h2> <ul><li><code>certutil</code></li></ul> <blockquote><p>用户备份证书服务管理，每次下载都会有缓存，缓存目录：<code>%USERPROFILE%\AppData\LocalLow\Microsoft\CryptnetUrlCache\Content</code></p></blockquote> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token command"><span class="token keyword">certutil</span> -urlcache -split <span class="token parameter attr-name">-f</span> https://blog-static.cnblogs.com/files/gayhub/bcn.js C:\Windows\bcn.bat</span>
</code></pre></div><ul><li><code>bitsadmin</code></li></ul> <blockquote><p><code>bitsadmin.exe</code> 是<code>windows</code>后台智能传输服务的一个工具，<code>windows</code>的自动更新，补丁之类的下载就是用这个工具来实现的。</p></blockquote> <div class="language-batch extra-class"><pre class="language-batch"><code><span class="token comment">:: /priority normal进度条等信息</span>
<span class="token command"><span class="token keyword">bitsadmin</span> <span class="token parameter attr-name">/transfer</span> 任务名 <span class="token parameter attr-name">/download</span> <span class="token parameter attr-name">/priority</span> normal https://blog-static.cnblogs.com/files/gayhub/bcn.js C:\Windows\bcn.bat</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vuePress-web-view/《Shell》笔记/Shell命令.html" class="prev">
        Shell命令
      </a></span> <span class="next"><a href="/vuePress-web-view/《Shell》笔记/WindowsJScript.html">
        WindowsJScript
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/vuePress-web-view/assets/js/app.e2c12251.js" defer></script><script src="/vuePress-web-view/assets/js/2.d261dd2c.js" defer></script><script src="/vuePress-web-view/assets/js/210.1bb356dc.js" defer></script>
  </body>
</html>
