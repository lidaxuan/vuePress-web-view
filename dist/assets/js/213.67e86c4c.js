(window.webpackJsonp=window.webpackJsonp||[]).push([[213],{620:function(t,s,a){"use strict";a.r(s);var n=a(12),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"windowsvbscript"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#windowsvbscript"}},[t._v("#")]),t._v(" WindowsVBScript")]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#flag"}},[t._v("Flag")])]),a("li",[a("a",{attrs:{href:"#特殊符号"}},[t._v("特殊符号")])]),a("li",[a("a",{attrs:{href:"#函数封装"}},[t._v("函数封装")]),a("ul",[a("li",[a("a",{attrs:{href:"#自动关闭弹窗"}},[t._v("自动关闭弹窗")])]),a("li",[a("a",{attrs:{href:"#数组转换为字符串"}},[t._v("数组转换为字符串")])]),a("li",[a("a",{attrs:{href:"#获取对象的属性和值"}},[t._v("获取对象的属性和值")])]),a("li",[a("a",{attrs:{href:"#获取系统信息"}},[t._v("获取系统信息")])]),a("li",[a("a",{attrs:{href:"#隐藏窗口运行"}},[t._v("隐藏窗口运行")])]),a("li",[a("a",{attrs:{href:"#查看进程是否存在"}},[t._v("查看进程是否存在")])]),a("li",[a("a",{attrs:{href:"#ping"}},[t._v("Ping")])]),a("li",[a("a",{attrs:{href:"#监视网络连接"}},[t._v("监视网络连接")])]),a("li",[a("a",{attrs:{href:"#监视网络断开"}},[t._v("监视网络断开")])]),a("li",[a("a",{attrs:{href:"#设置壁纸"}},[t._v("设置壁纸")])]),a("li",[a("a",{attrs:{href:"#刷新桌面"}},[t._v("刷新桌面")])]),a("li",[a("a",{attrs:{href:"#字符编码转换"}},[t._v("字符编码转换")])]),a("li",[a("a",{attrs:{href:"#选择文件对话框"}},[t._v("选择文件对话框")])]),a("li",[a("a",{attrs:{href:"#文件编码转换"}},[t._v("文件编码转换")])])])]),a("li",[a("a",{attrs:{href:"#vba"}},[t._v("VBA")])])])]),a("p"),t._v(" "),a("h2",{attrs:{id:"flag"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flag"}},[t._v("#")]),t._v(" Flag")]),t._v(" "),a("ul",[a("li",[t._v("批处理之家 "),a("a",{attrs:{href:"http://www.bathome.net",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://www.bathome.net"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("中国DOS联盟 "),a("a",{attrs:{href:"http://cndos.fam.cx/forum/forumdisplay.php?fid=23",target:"_blank",rel:"noopener noreferrer"}},[t._v("DOS批处理 & 脚本技术（批处理室）"),a("OutboundLink")],1)])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/previous-versions//t0aew7h6(v=vs.85)",target:"_blank",rel:"noopener noreferrer"}},[t._v("VBScript"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/dotnet/visual-basic",target:"_blank",rel:"noopener noreferrer"}},[t._v("Visual Basic 指南"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/previous-versions//d1wf56tt%28v%3dvs.85%29",target:"_blank",rel:"noopener noreferrer"}},[t._v("VBScript语言参考"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/previous-versions//0ad0dkea%28v%3dvs.85%29",target:"_blank",rel:"noopener noreferrer"}},[t._v("VBScript基础知识"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.tcoline.com/resource/vbs/top_vbs_0.htm",target:"_blank",rel:"noopener noreferrer"}},[t._v("VBScript 语言"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://code.ziqiangxuetang.com/vbscript/vbscript-tutorial.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("VBScript 教程"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.w3school.com.cn/vbscript/vbscript_ref_functions.asp",target:"_blank",rel:"noopener noreferrer"}},[t._v("VBScript 函数"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/MishaVernik/WScirpt",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/MishaVernik/WScirpt"),a("OutboundLink")],1)])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.runoob.com/vbscript/func-msgbox.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("VBScript MsgBox 函数"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"特殊符号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#特殊符号"}},[t._v("#")]),t._v(" 特殊符号")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/previous-versions//hh277t8e%28v%3dvs.85%29",target:"_blank",rel:"noopener noreferrer"}},[t._v("String Constants"),a("OutboundLink")],1)])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("常数")]),t._v(" "),a("th",[t._v("值")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("vbCr")]),t._v(" "),a("td",[t._v("Chr(13)")]),t._v(" "),a("td",[t._v("回车符 "),a("code",[t._v("\\r")])])]),t._v(" "),a("tr",[a("td",[t._v("vbLf")]),t._v(" "),a("td",[t._v("Chr(10)")]),t._v(" "),a("td",[t._v("换行符 "),a("code",[t._v("\\n")])])]),t._v(" "),a("tr",[a("td",[t._v("vbCrLf")]),t._v(" "),a("td",[t._v("Chr(13)&Chr(10)")]),t._v(" "),a("td",[t._v("回车符与换行符 "),a("code",[t._v("\\r\\n")])])]),t._v(" "),a("tr",[a("td",[t._v("vbFormFeed")]),t._v(" "),a("td",[t._v("Chr(12)")]),t._v(" "),a("td",[t._v("换页符；在MicrosoftWindows中不适用。")])]),t._v(" "),a("tr",[a("td",[t._v("vbNewLine")]),t._v(" "),a("td",[t._v("Chr(13)&Chr(10)或Chr(10)")]),t._v(" "),a("td",[t._v("平台指定的新行字符；适用于任何平台。")])]),t._v(" "),a("tr",[a("td",[t._v("vbNullChar")]),t._v(" "),a("td",[t._v("Chr(0)")]),t._v(" "),a("td",[t._v("值为0的字符。")])]),t._v(" "),a("tr",[a("td",[t._v("vbNullString")]),t._v(" "),a("td",[t._v("值为0的字符串")]),t._v(" "),a("td",[t._v('与零长度字符串("")不同；用于调用外部过程。')])]),t._v(" "),a("tr",[a("td",[t._v("vbTab")]),t._v(" "),a("td",[t._v("Chr(9)")]),t._v(" "),a("td",[t._v("水平附签。")])]),t._v(" "),a("tr",[a("td",[t._v("vbVerticalTab")]),t._v(" "),a("td",[t._v("Chr(11)")]),t._v(" "),a("td",[t._v("垂直附签；在MicrosoftWindows中不用")])])])]),t._v(" "),a("h2",{attrs:{id:"函数封装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#函数封装"}},[t._v("#")]),t._v(" 函数封装")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/eklam/VbsJson",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/eklam/VbsJson"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://stackoverflow.com/questions/18216027/vbscript-script-progress-notification",target:"_blank",rel:"noopener noreferrer"}},[t._v("进度条"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://stackoverflow.com/questions/50514348/how-do-i-make-a-fake-progress-bar-in-vbscript",target:"_blank",rel:"noopener noreferrer"}},[t._v("进度条"),a("OutboundLink")],1)])]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" regex "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("New")]),t._v(" RegExp\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" regex "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"VBScript.RegExp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nregex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Global")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\nregex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MultiLine "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\nregex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Pattern "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^\\s*\\n"')]),t._v("\nstr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" regex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Replace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"自动关闭弹窗"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自动关闭弹窗"}},[t._v("#")]),t._v(" 自动关闭弹窗")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' TimeOut 单位为秒")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" MsgBoxTimeout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Title"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" TimeOut"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" WshShell "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    WshShell"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Popup Text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" TimeOut"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Title\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n")])])]),a("h3",{attrs:{id:"数组转换为字符串"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数组转换为字符串"}},[t._v("#")]),t._v(" 数组转换为字符串")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'数组转换为字符串")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Writer         Bajins")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Create Date    2019-10-22")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'arrayName      数组")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'separator      separator")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'Example        ConvertArrayToString(array, ",")')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" ConvertArrayToString"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("array"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" separator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" elementString\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" element "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" array\n        elementString "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" elementString "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Cstr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" separator\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n\n    elementString "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" StrReverse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elementString"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    elementString "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Replace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elementString"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" separator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    elementString "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" StrReverse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elementString"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 设置返回值")]),t._v("\n    ConvertArrayToString "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" elementString\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n")])])]),a("h3",{attrs:{id:"获取对象的属性和值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取对象的属性和值"}},[t._v("#")]),t._v(" 获取对象的属性和值")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 获取对象的属性和值")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Writer         Bajins")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Create Date    2019-10-22")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'obj            对象")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Example        GetObjectPropertieValue(obj)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetObjectPropertieValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" IsObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Exit Function")]),t._v("\n        Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Raise Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Number\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("END")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" kv\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" Propertie "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Properties_\n       kv "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" kv "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Propertie"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('" : "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Propertie"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" vbCrLf\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n    \n    kv "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"属性数量："')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Properties_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" vbCrLf "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" kv\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 设置返回值")]),t._v("\n    GetObjectPropertieValue "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" kv\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n")])])]),a("h3",{attrs:{id:"获取系统信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取系统信息"}},[t._v("#")]),t._v(" 获取系统信息")]),t._v(" "),a("blockquote",[a("p",[t._v("此方式完全不会显示"),a("code",[t._v("CMD")]),t._v("窗口（包括闪现）")])]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 获取系统位数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Writer         Bajins")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Create Date    2019-10-22")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Example        GetSystemBit()")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetSystemBit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" WMIService "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GetObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"winmgmts:{impersonationlevel=impersonate}!\\\\.\\root\\cimv2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" ComputerSystem "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WMIService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("InstancesOf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Win32_ComputerSystem"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" System "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" ComputerSystem\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" InStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SystemType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"86"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n            GetSystemBit "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"i386"')]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" InStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SystemType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"64"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n            GetSystemBit "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"amd64"')]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n")])])]),a("h3",{attrs:{id:"隐藏窗口运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#隐藏窗口运行"}},[t._v("#")]),t._v(" 隐藏窗口运行")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 创建运行命令数组")]),t._v("\ncommands "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Array"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D:\\frp内网穿透工具\\frpc.exe -c D:\\frp内网穿透工具\\frpc.ini"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 创建运行命令动态数组")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'Set commands = CreateObject("System.Collections.ArrayList")')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'commands.Add "D:\\frp内网穿透工具\\frpc.exe -c D:\\frp内网穿透工具\\frpc.ini"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 启动项键名称")]),t._v("\nkeyName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"frp"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" shell "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WScript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" command "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" commands\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' cmd /c运行之后关闭窗口，0隐藏运行，false不同步运行")]),t._v("\n    shell"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Run "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cmd /c "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" command"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 注册表项")]),t._v("\nitem "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 设置开机启动")]),t._v("\nshell"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RegWrite item "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" keyName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" WScript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ScriptFullName\n")])])]),a("p",[a("strong",[t._v("Shell.Application")])]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[t._v("CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Shell.Application"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ShellExecute "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"demo.exe"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"c:/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n")])])]),a("h3",{attrs:{id:"查看进程是否存在"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看进程是否存在"}},[t._v("#")]),t._v(" 查看进程是否存在")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[t._v("ProcesseName"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rclone.exe"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 查找进程")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" WMIService "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GetObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"winmgmts:{impersonationlevel=impersonate}!\\\\.\\root\\cimv2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" Processes "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WMIService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExecQuery"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"select * from win32_process where name=\'"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" ProcesseName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\'"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" Process "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" Processes\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 比较两个字符串")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" InStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UCase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" UCase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProcesseName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 如果进程存在就不重复执行后面的代码")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 运行程序")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" WS "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Wscript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Wscript.Shell"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    WS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Run "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rclone mount GDrive:/ x: --cache-dir F:\\Temp --vfs-cache-mode writes"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n")])])]),a("h3",{attrs:{id:"ping"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ping"}},[t._v("#")]),t._v(" Ping")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" Ping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("strHostName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" colPingResults"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" objPingResult"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" strQuery \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 定义WMI查询")]),t._v("\n  strQuery "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SELECT * FROM Win32_PingStatus WHERE Address = \'"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" strHostName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\'"')]),t._v(" \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 运行WMI查询")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\' GetObject("winmgmts://./root/cimv2")')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" colPingResults "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GetObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"winmgmts:root\\cimv2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExecQuery"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("strQuery"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 将查询结果转换为True或False")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" objPingResult "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" colPingResults \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" IsObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("objPingResult"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" \n      Ping "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v(" \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v(" \n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" objPingResult"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StatusCode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" \n        Ping "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v(" \n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v(" \n        Ping "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v(" \n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" \n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'WScript.Echo "Ping status code for " & strHostName & ": " & objPingResult.StatusCode ')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" \n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v(" \n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" colPingResults "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("Nothing")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n")])])]),a("h3",{attrs:{id:"监视网络连接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#监视网络连接"}},[t._v("#")]),t._v(" 监视网络连接")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" objWMIService "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GetObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"winmgmts:\\\\.\\root\\wmi"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 执行事件订阅查询以接收事件。事件订阅查询定义了要监视的托管环境的更改。发生更改时，WMI基础结构会将事件描述为调用脚本。")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" colMonitoredEvents "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" objWMIService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExecNotificationQuery"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Select * from MSNdis_StatusMediaConnect"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Do")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("While")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v(" \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" strLatestEvent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" colMonitoredEvents"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NextEvent \n    Wscript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Echo "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"已建立网络连接："')]),t._v("\n    WScript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Echo strLatestEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("InstanceName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Now\n    Wscript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Echo \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Loop")]),t._v("\n")])])]),a("h3",{attrs:{id:"监视网络断开"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#监视网络断开"}},[t._v("#")]),t._v(" 监视网络断开")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" objWMIService "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GetObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"winmgmts:\\\\.\\root\\wmi"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 执行事件订阅查询以接收事件。事件订阅查询定义了要监视的托管环境的更改。发生更改时，WMI基础结构会将事件描述为调用脚本。")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" colMonitoredEvents "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" objWMIService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExecNotificationQuery"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Select * from MSNdis_StatusMediaDisconnect"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Do")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("While")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v(" \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" strLatestEvent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" colMonitoredEvents"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NextEvent \n    Wscript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Echo "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"网络连接已丢失："')]),t._v("\n    WScript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Echo strLatestEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("InstanceName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Now\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Loop")]),t._v("\n")])])]),a("h3",{attrs:{id:"设置壁纸"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置壁纸"}},[t._v("#")]),t._v(" 设置壁纸")]),t._v(" "),a("blockquote",[a("p",[t._v("使用API触发图片文件右键菜单上的 "),a("code",[t._v("设置为桌面背景(B)")])])]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" shApp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Shell.Application"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 获取文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" picFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Scripting.FileSystemObject"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"C:\\Users\\bajin\\Desktop\\CachedImage_1920_1080_POS4.jpg"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 获取文件上的所有右键菜单项")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Set items = shApp.NameSpace(picFile.ParentFolder.Path).ParseName(picFile.Name).Verbs()")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" items "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" shApp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("NameSpace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("picFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ParentFolder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Items"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("picFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Verbs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 遍历所有菜单项")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' For i=0 To items.Count - 1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Set item = items.Item(i)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" item "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" items\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 注意执行的脚本文件需要为简体中文编码")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"设置为桌面背景(&B)"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\' If strcomp(item.Name,"设置为桌面背景(&B)") = 0 Then')]),t._v("\n        item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DoIt\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("END")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n")])])]),a("h3",{attrs:{id:"刷新桌面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#刷新桌面"}},[t._v("#")]),t._v(" 刷新桌面")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 切换到桌面")]),t._v("\nCreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Shell.Application"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ToggleDesktop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 刷新桌面")]),t._v("\nCreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SendKeys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{F5}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" WSHShell "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 切换到桌面")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'WSHShell.AppActivate("Program Manager")')]),t._v("\nWSHShell"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AppActivate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("WSHShell"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SpecialFolders"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Desktop"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 刷新桌面")]),t._v("\nWSHShell"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SendKeys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{F5}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 下面这两种方式没看出效果")]),t._v("\nCreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"shell.application"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Namespace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("invokeVerb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"R&efresh"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nCreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"shell.application"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Namespace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("&H10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("invokeVerb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Refresh"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 刷新桌面、任务栏、OSD（相当于重启资源管理器）")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" WSHShell "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nWSHShell"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Run "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"regsvr32.exe /s /n /i:/UserInstall %SystemRoot%\\system32\\themeui.dll"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 效果不太好，有时刷新成功，有时失败")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" WSHShell "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nWSHShell"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Run "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"RunDll32 USER32,UpdatePerUserSystemParameters"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' assoc文件关联时会自动刷新桌面，可能报错")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" WSHShell "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nWSHShell"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Run "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"assoc .=."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 重启资源管理器并恢复打开的目录，暂时不可用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" RestartExplorer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" arrURL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    n "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" shApp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Shell.Application"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 遍历所有打开的窗口")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" oWin "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" shApp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Windows\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 如果打开的窗口为资源管理器")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" Instr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oWin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FullName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\explorer.exe"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vbTextCompare"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n            n "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" n "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ReDim")]),t._v(" Preserve arrURL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            arrURL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oWin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LocationURL\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'oWin.Document.folder.title")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 关闭当前打开的文件夹")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'oWin.quit")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 结束资源管理器进程")]),t._v("\n    CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Run "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"taskkill /f /im explorer.exe >nul 2>nul&start explorer.exe"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 遍历并打开之前的窗口")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" strURL "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" arrURL\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'shApp.Open strURL")]),t._v("\n        shApp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Explore strURL\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n")])])]),a("h3",{attrs:{id:"字符编码转换"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#字符编码转换"}},[t._v("#")]),t._v(" 字符编码转换")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 将UTF8编码文字转换为GB编码文字")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" UTF2GB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UTFStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" Dig"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UTFStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'如果UTF8编码文字以%开头则进行转换")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UTFStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Dig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'UTF8编码文字大于8则转换为汉字")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UTFStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Dig"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n            GBStr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("GBStr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" ConvChinese"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UTFStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            Dig"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Dig"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n            GBStr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("GBStr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UTFStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n        GBStr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("GBStr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UTFStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\n    UTF2GB"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("GBStr\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' UTF8编码文字将转换为汉字")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" ConvChinese"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     A"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("split"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n     j"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" ubound"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n       A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("c16to2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" ubound"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n      DigS"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("instr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      Unicode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" j"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" DigS"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" j"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n          A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("right"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("DigS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          Unicode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Unicode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n           i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n           A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("right"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n           Unicode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Unicode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\n \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c2to16"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Unicode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n         ConvChinese"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ConvChinese "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" chrw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("int"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"&H"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" c2to16"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Unicode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n         ConvChinese"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ConvChinese "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" chr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("int"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"&H"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" c2to16"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Unicode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'二进制代码转换为十六进制代码")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" c2to16"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("step")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\n            c2to16"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("c2to16 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" hex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c2to10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'二进制代码转换为十进制代码")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" c2to10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    c2to10"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" x"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n        i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" c2to10"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("c2to10"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'十六进制代码转换为二进制代码")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" c16to2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("trim"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        tempstr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" c10to2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("cint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("int"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"&h"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tempstr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\n            tempstr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" tempstr\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("loop")]),t._v("\n        c16to2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("c16to2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" tempstr\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'十进制代码转换为二进制代码")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" c10to2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    mysign"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("sgn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    x"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("abs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    DigS"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" x"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),t._v("DigS "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n            DigS"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("DigS"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("loop")]),t._v("\n        tempnum"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("x\n\n        i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("DigS "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("step")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" tempnum"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n            tempnum"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("tempnum"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            c10to2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("c10to2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n            c10to2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("c10to2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" mysign"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" c10to2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" c10to2\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'GB转unicode---将GB编码文字转换为unicode编码文字")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" chinese2unicode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("dim")]),t._v(" i\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("dim")]),t._v(" Str_one\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("dim")]),t._v(" Str_unicode\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isnull"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     Str_one"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     Str_unicode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Str_unicode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("chr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("38")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     Str_unicode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Str_unicode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("chr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("35")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     Str_unicode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Str_unicode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("chr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("120")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     Str_unicode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Str_unicode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Hex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ascw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Str_one"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     Str_unicode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Str_unicode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("chr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("59")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\n   chinese2unicode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Str_unicode\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("   \n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'URL解码")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" URLDecode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("dim")]),t._v(" deStr\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("dim")]),t._v(" c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("v\ndeStr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    c"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" c"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    v"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("eval"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"&h"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("Mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" v"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n        deStr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("deStr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("chr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" isvalidhex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enstr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" isvalidhex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enstr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n        v"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("eval"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"&h"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("Mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("Mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        deStr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("deStr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("chr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n        v"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("eval"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"&h"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("Mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("cstr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("asc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        deStr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("deStr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("chr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n        destr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("destr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("c\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" c"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"+"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n        deStr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("deStr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('" "')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n        deStr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("deStr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("c\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("next")]),t._v("\nURLDecode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("deStr\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'判断是否为有效的十六进制代码")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" isvalidhex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("dim")]),t._v(" c\n    isvalidhex"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    str"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ucase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" isvalidhex"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" left"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" isvalidhex"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n    c"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("and")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"9"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("or")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("and")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Z"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" isvalidhex"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n    c"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("and")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"9"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("or")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("and")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Z"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" isvalidhex"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v("\n")])])]),a("h3",{attrs:{id:"选择文件对话框"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#选择文件对话框"}},[t._v("#")]),t._v(" 选择文件对话框")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" SelectFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" WshShell "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WScript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" oExec "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WshShell"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Exec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"powershell -WindowStyle Hidden -ExecutionPolicy Bypass "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"[void][System.Reflection.Assembly]::LoadWithPartialName('System.Windows.Forms');\"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"$dialog = New-Object 'System.Windows.Forms.OpenFileDialog';\"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"$dialog.Title ='请选择文件';\"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"$dialog.filter ='All|*.*|PowerShell|*.ps1';\"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"if ($dialog.ShowDialog() -eq 'OK') {$dialog.FileName;} Else {Out-Null}\"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    SelectFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oExec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StdOut"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ReadAll\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" SelectFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' GetStandardStream获取TextStream对象.参数：0输入流,1输出流,2错误流.")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\' "new ActiveXObject(\'Scripting.FileSystemObject\').GetStandardStream(1).Write(f.value);" & _\n    hta="""about:<input type=file id=f><script>f.click();" & _\n        "new ActiveXObject(\'Scripting.FileSystemObject\').GetStandardStream(1).WriteLine(f.value);" & _\n        "close();resizeTo(0,0);<\/script>"""')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 打开对话框")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" oExec "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Exec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mshta.exe "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" hta"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    StrLine "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oExec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StdOut"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ReadLine\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' StrLine = oExec.StdOut.ReadAll")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" StrLine "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("And")]),t._v(" InStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("StrLine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Chr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' SelectFile = Left(StrLine, Pos - 1)")]),t._v("\n        SelectFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" StrLine\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n        SelectFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' sIniDir 为初始化目录")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\' sFilter 为文件后缀 示例："*.*,*.txt"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetFileDlgEx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sIniDir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sFilter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sTitle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    sIniDir "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Replace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sIniDir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\\\"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Set regex = New RegExp")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" regex "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"VBScript.RegExp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    regex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Global")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n    regex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MultiLine "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n    regex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Pattern "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('";|\\|"')]),t._v("\n    sFilter "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" regex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Replace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sFilter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('","')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DIM")]),t._v(" sf\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" Split"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sFilter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('","')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        sf "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sf "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"|"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"|"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n    sFilter "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sf\n    hta"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"""about:<object id=d classid=clsid:3050f4e1-98b5-11cf-bb82-00aa00bdce0b></object>"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<script>moveTo(0,-9999);"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"eval(new ActiveXObject('Scripting.FileSystemObject').GetStandardStream(0)\"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('".Read("')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("Len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sIniDir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("Len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sFilter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("Len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sTitle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("41")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"));"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"function window.onload(){"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"var p=/[^\\0]*/;"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"new ActiveXObject('Scripting.FileSystemObject').GetStandardStream(1)\"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('".Write(p.exec(d.object.openfiledlg(iniDir,null,filter,title)));"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"close();"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"}<\/script><hta:application showintaskbar=no />"""')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" oDlg "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Exec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mshta.exe "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" hta"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n    oDlg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StdIn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Write "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"var iniDir=\'"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" sIniDir "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"';var filter='\"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" sFilter "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"';var title='\"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" sTitle "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\';"')]),t._v(" \n    GetFileDlgEx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oDlg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StdOut"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ReadAll \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" BrowseForFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WScript.Shell"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" fso "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" fso "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Scripting.FileSystemObject"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" tempFolder "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" tempFolder "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fso"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetSpecialFolder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" tempName "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" tempName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fso"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetTempName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('".hta"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" path "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" path "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HKCU\\Volatile Environment\\MsgResp"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" tempFolder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreateTextFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tempName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Write "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<input type=file name=f>"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"<script>f.click();(new ActiveXObject('WScript.Shell'))\"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".RegWrite('HKCU\\\\Volatile Environment\\\\MsgResp', f.value);\"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"close();<\/script>"')]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Close\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Run tempFolder "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" tempName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n        BrowseForFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RegRead"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RegDelete path\n        fso"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DeleteFile tempFolder "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" tempName\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" SelectFolder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" objShell "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Shell.Application"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" IsNull"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Set objFolder = objShell.Namespace(&H11) ' 获取当前计算机")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' default = objFolder.Self.Path")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' https://docs.microsoft.com/zh-cn/windows/win32/shell/shell-browseforfolder")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 第一个参数：为对话框的窗体句柄，一般设置为0")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 第二个参数：为打开窗体的说明")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 第三个参数：0/1/2/3/257/4097/8193/12289/16385/20481只从列表进行选择（列表内容不一样），")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'       529没有路径输入框，513没有路径输入框和新建文件夹按钮，&H10（17）有路径输入框，")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'       &H4000可看到文件但选择将报错;")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' 第四个参数：起始路径根文件夹，0/12/15/16为桌面，1/2/3/4/5/6/7/8/9/10/11/13/14/17/18/19/20/21/22")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" Folder "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" objShell"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BrowseForFolder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"请选择一个文件夹:"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("&H10")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" Folder "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Is")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("Nothing")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" \n        SelectFolder "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n        SelectFolder "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Folder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Path\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n")])])]),a("h3",{attrs:{id:"文件编码转换"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件编码转换"}},[t._v("#")]),t._v(" 文件编码转换")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://blog.csdn.net/chuhe163/article/details/103549144",target:"_blank",rel:"noopener noreferrer"}},[t._v("VBS处理UTF-8文本之ADODB.stream"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"/files/%E6%96%87%E4%BB%B6%E7%BC%96%E7%A0%81%E8%BD%AC%E6%8D%A2.vbs"}},[t._v("文件编码转换.vbs")])])]),t._v(" "),a("p",[a("strong",[t._v("转换编码和换行符")])]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" read "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Adodb.Stream"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\nread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\nread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("charset "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UTF-8"')]),t._v("\nread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Open\nread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("loadfromfile fdpath\ntext "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" read"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ReadText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("flush\nread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Close\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" save "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Adodb.Stream"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsave"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\nsave"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\nsave"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("charset "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GB2312"')]),t._v("\nsave"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Open\nsave"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WriteText replace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("vbLf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("vbCrLf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsave"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SaveToFile fdpath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\nsave"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("flush\nsave"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Close\n")])])]),a("h2",{attrs:{id:"vba"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vba"}},[t._v("#")]),t._v(" VBA")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/office/vba/api/overview/language-reference",target:"_blank",rel:"noopener noreferrer"}},[t._v("Visual Basic for Applications (VBA) 语言参考"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("Microsoft Office Development "),a("a",{attrs:{href:"https://bettersolutions.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://bettersolutions.com"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.zhihu.com/people/xia-xi-lan/posts",target:"_blank",rel:"noopener noreferrer"}},[t._v("VBA学习笔记"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://blog.csdn.net/wordsin/article/details/80575615",target:"_blank",rel:"noopener noreferrer"}},[t._v("xcel之VBA简单宏编程"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.zhihu.com/people/xia-xi-lan/posts",target:"_blank",rel:"noopener noreferrer"}},[t._v("VBA学习笔记"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://blog.csdn.net/wordsin/article/details/80575615",target:"_blank",rel:"noopener noreferrer"}},[t._v("xcel之VBA简单宏编程"),a("OutboundLink")],1)])]),t._v(" "),a("ul",[a("li",[t._v('匹配单元格左边英文及其他字符=RegexString(A1,"[^\\u4e00-\\u9fa5]+")')]),t._v(" "),a("li",[t._v('匹配单元格右边中文及其他字符=RegexString(A1,"[\\u4e00-\\u9fa5].*")')])]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" RegexString"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rng "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" str "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'第一个参数rng为区域保持不变， 添加第二个参数str（作为正则表达式）")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"VBscript.regexp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Global")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Pattern "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'表达式,直接从用户函数的第二个参数中调用")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Execute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n    RegexString "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n    RegexString "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Execute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n")])])]),a("ul",[a("li",[t._v("分割字符串并统计")])]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'https://blog.csdn.net/wordsin/article/details/80575615")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'自定义函数用于工作表时，必须是被动式的，只是返回一个值，不能处理单元格或在工作表上修改，批注是个例外，不能调用range的方法，如：Find，Range.Replace例外")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" ReSplit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rng "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" newStr "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" countNum "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Integer")]),t._v("\n    \n    old "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Strings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Split"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('" "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" e "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" old\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" e "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'MsgBox TypeName(e)")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'Replace(, "/", "")')]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"VBSCRIPT.REGEXP"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Global")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IgnoreCase "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Pattern "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"([a-zA-Z]+)([0-9]+)-([0-9]+)"')]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'执行正则表达式，获取子匹配列表")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" da "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Execute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SubMatches\n                    last "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" da"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                    st "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" da"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                    en "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" da"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Debug.Print last, st, en")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" st "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("To")]),t._v(" en\n                        newStr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newStr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('","')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" last "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" i\n                        countNum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" countNum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n                    newStr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newStr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('","')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" e\n                    countNum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" countNum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" InStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('","')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        newStr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Right"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    Debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print newStr\n    Debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print countNum\n    \n    ReSplit "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newStr\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'ActiveCell.Address '这是当前单元格地址")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Selection.Offset(1, 0).Select '这是向下跳1格")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Selection.Offset(-1, 0).Select '这是向上跳1格")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Selection.Offset(0, -1).Select '这是向左跳1格")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Selection.Offset(0, 1).Select '这是向右跳1格")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" SplitCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rng "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" delimiter "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   SplitCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Strings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Split"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" delimiter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" SetValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("offset "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    offset "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" rng "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("InputBox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("prompt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"请选择区域"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" rng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        MsgBox "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"请至少选择一个单元格！"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"提示"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'If rng.Count <> 1 Then")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'MsgBox "只能选择一个单元格！", , "提示":')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Exit Sub")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'End If")]),t._v("\n    Debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"当前选择："')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Address"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n    rngs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Strings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Split"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Address"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('":"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    st "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Strings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Split"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rngs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    sta "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Replace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rngs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Debug.Print rngs(0), st, sta")]),t._v("\n    \n    of1Content "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"整理后的数据"')]),t._v("\n    of2Content "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"整理后的统计"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("st "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" of1Content "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'插入空列")]),t._v("\n        Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sta"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EntireColumn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Insert\n        Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("st "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" of1Content\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("st "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" of2Content "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sta"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EntireColumn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Insert\n        Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("st "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" of2Content\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" im "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" rng\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" im "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Debug.Print TypeName(im), im.Address")]),t._v("\n            \n            str1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ReSplit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Replace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("im"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Address"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            im"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str1\n            im"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CountA"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Strings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Split"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('","')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);