(window.webpackJsonp=window.webpackJsonp||[]).push([[206],{613:function(t,s,a){"use strict";a.r(s);var n=a(12),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"powershell"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#powershell"}},[t._v("#")]),t._v(" PowerShell")]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#flag"}},[t._v("Flag")])]),a("li",[a("a",{attrs:{href:"#包管理"}},[t._v("包管理")])]),a("li",[a("a",{attrs:{href:"#在batch中嵌入运行"}},[t._v("在batch中嵌入运行")])]),a("li",[a("a",{attrs:{href:"#windows10自带应用"}},[t._v("Windows10自带应用")])]),a("li",[a("a",{attrs:{href:"#命令"}},[t._v("命令")]),a("ul",[a("li",[a("a",{attrs:{href:"#事件计划任务"}},[t._v("事件计划任务")])])])]),a("li",[a("a",{attrs:{href:"#常用命令"}},[t._v("常用命令")])]),a("li",[a("a",{attrs:{href:"#随机字符串"}},[t._v("随机字符串")])]),a("li",[a("a",{attrs:{href:"#http服务"}},[t._v("HTTP服务")])]),a("li",[a("a",{attrs:{href:"#弹窗"}},[t._v("弹窗")])])])]),a("p"),t._v(" "),a("h2",{attrs:{id:"flag"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flag"}},[t._v("#")]),t._v(" Flag")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("PowerShell")]),t._v("的命令叫做"),a("code",[t._v("cmdlet")]),t._v("("),a("code",[t._v("command-let")]),t._v("), 采用了“动词-名词”的命名方式，动词部分取自于一个制定的动词集合，\n名词部分则描述了命令要操作的对象。例如，"),a("code",[t._v("Get-Command")]),t._v("就是指获取"),a("code",[t._v("PowerShell")]),t._v("中所有"),a("code",[t._v("cmdlet")]),t._v("命令。")])]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("PowerShell")]),t._v("提供对"),a("code",[t._v("COM")]),t._v("（组件对象模型）和"),a("code",[t._v("WMI")]),t._v("（Windows管理规范）的完全访问，具有丰富的控制与自动化的系统管理能力，\n能够轻松地做到实时、大规模的管理系统。获取本机所有"),a("code",[t._v("COM")]),t._v("组件对象脚本 "),a("a",{attrs:{href:"/files/Get-COM-Objects.ps1"}},[t._v("Get-COM-Objects.ps1")])])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/janikvonrotz/awesome-powershell",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/janikvonrotz/awesome-powershell"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/PowerShell",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/PowerShell"),a("OutboundLink")],1)])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.zhihu.com/question/22611859/answers/updated",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell 与 cmd 有什么不同？"),a("OutboundLink")],1)])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/powershell",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.microsoft.com/zh-cn/powershell"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/powershell/module/cimcmdlets/?view=powershell-7.1",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell参考文档"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.pstips.net/why-is-powershell-powerful.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell为什么强大"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.pstips.net/powershell-online-tutorials",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell 在线教程"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/60797627",target:"_blank",rel:"noopener noreferrer"}},[t._v("Powershell入门指南(一)·PowerShell及CLI发展"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/60798130",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell入门指南(二)·挑战CMD和Bash的PowerShell"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/76708298",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell入门指南(三)·一门新的编程语言"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.pstips.net/speeding-up-powershell-multithreading.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell提速和多线程"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/MerLin-LiuNian/category/2027025.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell - 随笔分类 - 门前有根大呲花 - 博客园"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("WMIC 已弃用替代品 "),a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/powershell/module/microsoft.powershell.management/get-wmiobject",target:"_blank",rel:"noopener noreferrer"}},[t._v("Get-WmiObject"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("WMIC 已弃用替代品 "),a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/powershell/module/cimcmdlets/get-ciminstance",target:"_blank",rel:"noopener noreferrer"}},[t._v("Get-CimInstance"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://forsenergy.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://forsenergy.com"),a("OutboundLink")],1)])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/R3MRUM/PSDecode",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/R3MRUM/PSDecode"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/rootclay/Powershell-Attack-Guide",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/rootclay/Powershell-Attack-Guide"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/rootclay/Windows-Access-Control",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/rootclay/Windows-Access-Control"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"包管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#包管理"}},[t._v("#")]),t._v(" 包管理")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/microsoft/winget-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/microsoft/winget-cli"),a("OutboundLink")],1),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/microsoft/winget-pkgs",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/microsoft/winget-pkgs"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/oneget/oneget",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/oneget/oneget"),a("OutboundLink")],1),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.nuget.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.nuget.org"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.powershellgallery.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.powershellgallery.com"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/chocolatey",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/chocolatey"),a("OutboundLink")],1),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://chocolatey.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://chocolatey.org"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/lukesampson/scoop",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/lukesampson/scoop"),a("OutboundLink")],1),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/ScoopInstaller",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/ScoopInstaller"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/lukesampson/scoop-extras",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/lukesampson/scoop-extras"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/cmderdev/cmder",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/cmderdev/cmder"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/appget",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/appget"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"在batch中嵌入运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在batch中嵌入运行"}},[t._v("#")]),t._v(" 在batch中嵌入运行")]),t._v(" "),a("blockquote",[a("p",[t._v("由于Power Shell默认没有开启运行脚本策略，可以以此方式解决")])]),t._v(" "),a("blockquote",[a("p",[t._v("正则表达式排除以"),a("code",[t._v("@")]),t._v("和"),a("code",[t._v(":")]),t._v("开头的行，并将其他所有内容传递给Power Shell")])]),t._v(" "),a("div",{staticClass:"language-batch extra-class"},[a("pre",{pre:!0,attrs:{class:"language-batch"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("@")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("findstr")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[t._v("/v")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^@.* ^:.*"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%~f0"')]),t._v("|powershell -WindowStyle Hidden -ExecutionPolicy Bypass -")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("goto")]),a("span",{pre:!0,attrs:{class:"token label property"}},[t._v(":eof")])]),t._v("\n<# 从这里开始是 Power Shell代码 #>\n")])])]),a("blockquote",[a("p",[t._v("这里巧妙的借用Power Shell的注释把bat脚本命令包裹，把整个脚本内容传入Power Shell并执行")])]),t._v(" "),a("div",{staticClass:"language-batch extra-class"},[a("pre",{pre:!0,attrs:{class:"language-batch"}},[a("code",[t._v("<# ::\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("@")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("powershell")]),t._v(" -WindowStyle Hidden -ExecutionPolicy Bypass -<"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("%~f0")]),t._v(" ")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("goto")]),a("span",{pre:!0,attrs:{class:"token label property"}},[t._v(":eof")])]),t._v("\n#>\n# 保存到bat文件中可以双击执行，从这里开始是Power Shell代码\n")])])]),a("h2",{attrs:{id:"windows10自带应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#windows10自带应用"}},[t._v("#")]),t._v(" Windows10自带应用")]),t._v(" "),a("blockquote",[a("p",[t._v("注意空格和英文标点")])]),t._v(" "),a("ul",[a("li",[t._v("查看已安装应用")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-AppxPackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Select")]),t._v(" Name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("PackageFullName\n")])])]),a("ul",[a("li",[t._v("卸载应用程序")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 卸载所有账户中的应用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-AppxPackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("AllUsers "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Remove-AppxPackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 从系统账户中卸载应用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-AppXProvisionedPackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("online "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Remove-AppxProvisionedPackage")]),t._v(" –online\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 应用商店")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("store* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-Appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 日历、邮件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-AppxPackage")]),t._v(" Microsoft"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("windowscommunicationsapps "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Remove-AppxPackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("communicationsapps* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 从系统账户中卸载日历、邮件应用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-AppXProvisionedPackage")]),t._v(" –online "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("where-object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("packagename –like "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*windowsmunicationsapps*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxprovisionedpackage")]),t._v(" –online\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 人脉")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("people* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Groove 音乐")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("zunemusic* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 电影和电视")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("zunevideo* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 财经")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("bingfinance* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 资讯")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("bingnews* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 体育")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("bingsports* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 天气")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("bingweather* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# OneNote")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("onenote* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 便笺 https://onenote.com/stickynotes")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("stickynotes* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# TODO https://to-do.microsoft.com")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# https://www.microsoft.com/zh-cn/microsoft-365/microsoft-to-do-list-app")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("todo* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 闹钟和时钟")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("alarms* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 计算器")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("calculator* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 相机")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("camera* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 照片")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("photos* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 地图")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("maps* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 录音机")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("soundrecorder* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# XBox")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("xbox* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n")])])]),a("ul",[a("li",[t._v("恢复应用程序")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 应用商店")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("register "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"C:\\Program Files\\WindowsApps\\*Store*\\AppxManifest.xml"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("disabledevelopmentmode\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 计算器")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-AppxPackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("calculator* "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("AllUsers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Foreach")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("`\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add-AppxPackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("DisableDevelopmentMode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Register "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("InstallLocation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])]),t._v('\\AppXManifest.xml"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 日历、邮件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-AppxPackage")]),t._v(" Microsoft"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("windowscommunicationsapps "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("AllUsers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Foreach")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("`\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add-AppxPackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("DisableDevelopmentMode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Register "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("InstallLocation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])]),t._v('\\AppXManifest.xml"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令"}},[t._v("#")]),t._v(" 命令")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("ASCII")]),t._v(" 为无BOM"),a("code",[t._v("UTF-8")]),t._v("编码")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 列出所有的环境变量")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ChildItem")]),t._v(" env:\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gci")]),t._v(" env:\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dir")]),t._v(" env:\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" env:\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取环境变量的值")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$env")]),t._v(":变量名\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除环境变量")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("del")]),t._v(" env:变量名\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 更新环境变量")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$env")]),t._v(":变量名="),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"变量值"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# .NET方法操作可以全局生效")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 修改当前用户的环境变量（永久），只对新进程有效")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[environment]")]),t._v("::SetEnvironmentvariable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"变量名"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"值"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[EnvironmentVariableTarget]")]),t._v("::User"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置系统环境变量（永久），只对新进程有效，需要管理员权限")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[environment]")]),t._v("::SetEnvironmentvariable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"变量名"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"值"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[EnvironmentVariableTarget]")]),t._v("::Machine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# target 也可用字符串指定")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[environment]")]),t._v("::SetEnvironmentvariable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"变量名"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"值"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"User"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[environment]")]),t._v("::GetEnvironmentvariable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"变量名"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"变量名"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看输出的命令集")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Command")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("verb out\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Export-Csv")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Export-CliXML")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Out-file")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Out-GridView")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 独立弹窗")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ConvertTo-HTML")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Out-file")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("echo")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Write-Output")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("out-host")]),t._v("\n")])])]),a("ul",[a("li",[t._v("查看版本")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看Power Shell版本")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$PSVersionTable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PSVersion\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Version"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Major\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看当前PowerShell的.Net运行版本")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$PSVersionTable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CLRVersion\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看所有安装的.Net 版本")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'HKLM:\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sort-object")]),t._v(" name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Descending "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select-object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ExpandProperty PSChildName\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看安装的.Net 客户端版本")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ItemProperty")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'HKLM:\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v4\\Client'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Name Version"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Version\n")])])]),a("ul",[a("li",[t._v("为本账户启用执行脚本策略")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Set-ExecutionPolicy")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ExecutionPolicy RemoteSigned "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Scope CurrentUser\n")])])]),a("div",{staticClass:"language-ps1 extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms\n# https://docs.microsoft.com/zh-tw/dotnet/api/microsoft.win32\n# https://docs.microsoft.com/zh-cn/dotnet/api/microsoft.visualbasic\n# 加载引用程序集\n[void][System.Reflection.Assembly]::LoadWithPartialName('System.Windows.Forms');\n$null = [System.Reflection.Assembly]::LoadWithPartialName('System.Windows.Forms');\n[System.Reflection.Assembly]::LoadWithPartialName('System.Windows.Forms')  | Out-Null; # 最慢\nAdd-Type -assembly \"System.Windows.Forms\"\nAdd-Type -AssemblyName System.Windows.Forms\n\n[void][System.Windows.Forms.MessageBox]::Show(\"弹窗\");\n")])])]),a("ul",[a("li",[t._v("下载代码并通过"),a("code",[t._v("Invoke-Expression")]),t._v("执行")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Invoke-Expression")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("New-Object")]),t._v(" System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Net"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WebClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DownloadString"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://get.scoop.sh'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[t._v("下载文件")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("New-Object")]),t._v(" System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Net"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WebClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DownloadFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://git.io/JvYAg'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'d:\\\\7za.exe'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[t._v("循环目录")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取子目录和文件并遍历")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ChildItem")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ForEach-Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Process")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$project_name")]),t._v(" = "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果为子目录")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-is")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[System.IO.DirectoryInfo]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 切换到子目录")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Set-location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FullName\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 判断目录是否存在")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Test-Path")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("git"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            git remote "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("v\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Write-Host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PadLeft"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("15"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"开始更新 '),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$project_name")]),t._v(' "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PadRight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("30"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            git pull\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Set-Location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ul",[a("li",[t._v("创建硬软连接")])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/sysinternals/downloads/junction",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.microsoft.com/zh-cn/sysinternals/downloads/junction"),a("OutboundLink")],1)])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 软连接SymbolicLink：支持跨分区，支持文件和目录，支持相对路径，支持跨文件系统")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 硬链接HardLink：不可跨分区，盘符修改不影响，不能为文件夹创建硬链接")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("New-Item")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ItemType SymbolicLink `\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path C:\\ `\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Name hosts `\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Target "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"C:\\Windows\\System32\\drivers\\etc\\hosts"')]),t._v("\n")])])]),a("ul",[a("li",[t._v("创建文件夹")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("New-Item")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ItemType directory "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path 目录的路径\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 只列出目录")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-is")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[System.IO.DirectoryInfo]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PSIsContainer "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Mode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Substring"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-eq")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"d"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 只列出文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-is")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[System.IO.FileInfo]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PSIsContainer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-eq")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("$false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Mode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Substring"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-ne")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"d"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过管道过滤2020年5月12日后更改过的文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreationTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-gt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[datetime]")]),t._v("::Parse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"May 12, 2020"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取2周以内更改过的文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreationTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-gt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AddDays"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("14"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ul",[a("li",[t._v("重命名")])]),t._v(" "),a("div",{staticClass:"language-ps1 extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ls -Recurse -File -Include *.war,*.jar | ForEach-Object { Rename-Item -Path $_.fullname -newname ('test_' + $_.name)}\nls -Recurse -File -Include *.war,*.jar | ForEach-Object { Rename-Item -Path $_.fullname -newname ($_.name -replace 'test_','')}\nls -Recurse -File -Include *.war,*.jar | ForEach-Object -Begin {$count = 1}  -Process{`\n Rename-Item -Path $_.fullname -newname \"$_.basename$count$_.Extension\";$count++}\n")])])]),a("ul",[a("li",[t._v("复制文件及目录结构")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 源路径最后一个文件夹名为需要复制的目录结构的顶级文件夹名")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Copy-Item")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Recurse 源路径 目标路径 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Filter")]),t._v(" 文件名\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# .create()方法可以创建不存在的目录")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[IO.DirectoryInfo]")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$to")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("create"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 复制多个文件到指定目录")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-childitem")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("path "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D:\\demo"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("include @"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test.java'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("recurse `\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("copy-item")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("destination "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("new-item")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("path "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$env")]),t._v(':HOMEPATH\\Desktop\\demo"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"directory"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[t._v("删除空目录")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ChildItem")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path 路径 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Recurse "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force `\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PSIsContainer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-and")]),t._v(" `\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ChildItem")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FullName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Recurse "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force `\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PSIsContainer "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-eq")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$null")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" `\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Remove-Item")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Recurse\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ChildItem")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("recurse "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" Where "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PSIsContainer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-and")]),t._v(" `\n@"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ChildItem")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Lit "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Fullname "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" Where "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PSIsContainer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-eq")]),t._v(" 0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" `\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Remove-Item")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("recurse "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("whatif\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-childitem")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("recurse "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" ? "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-match")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"DirectoryInfo"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" `\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" ?"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetFiles"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-eq")]),t._v(" 0 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-and")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetDirectories"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-eq")]),t._v(" 0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("whatif\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("recurse "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" where "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("@"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("force "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fullname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("whatif "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force\n")])])]),a("ul",[a("li",[t._v("递归删除排除之外的文件")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path 源路径 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Include "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Exclude @"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test.css'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a*'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Recurse "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("del")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Recurse\n")])])]),a("ul",[a("li",[t._v("删除旧文件（指定日期之前的）")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ChildItem")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("recurse "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" Where "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PSIsContainer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-and")]),t._v(" `\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LastWriteTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-lt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AddDays"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("31"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Remove-Item")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("whatif\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ChildItem")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path 路径 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Recurse "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force `\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PSIsContainer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-and")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreationTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-lt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AddDays"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("15"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" `\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Remove-Item")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-childitem")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("recurse "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" ? "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-match")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"FileInfo"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" `\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" ?"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LastWriteTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-lt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[datetime]")]),t._v("::now"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("adddays"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("30"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("whatif "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force\n")])])]),a("ul",[a("li",[t._v("格式化时间")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Date")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Format "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyy-MM-dd hh:mm:ss'")]),t._v("\n")])])]),a("p",[a("strong",[t._v("调用DLL")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("DllImport"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kernel32.dll"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nprivate static extern int GetPrivateProfileSection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("string lpAppName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" byte"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" lpszReturnBuffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" int nSize"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" string lpFileName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Lock-WorkStation")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$signature")]),t._v(" = @"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\n        [DllImport("')]),t._v("user32"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dll"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('", SetLastError = true)]\n        public static extern bool LockWorkStation();\n    "')]),t._v("@\n    \n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$LockWorkStation")]),t._v(" = "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add-Type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("memberDefinition "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$signature")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Win32LockWorkStation"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("namespace Win32Functions "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("passthru\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$LockWorkStation")]),t._v("::LockWorkStation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Out-Null")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[a("strong",[t._v("查看进程启动参数")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看所有进程")]),t._v("\nwmic "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("process")]),t._v(" get caption"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("commandline "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("value\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看单个进程")]),t._v("\nwmic "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("process")]),t._v(" where caption="),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"svchost.exe"')]),t._v(" get caption"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("commandline "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("value\nwmic "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("process")]),t._v(" get caption"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("commandline "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("value "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" findstr "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"svchost.exe"')]),t._v("\n")])])]),a("p",[a("strong",[t._v("解压zip")])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/powershell/module/microsoft.powershell.archive",target:"_blank",rel:"noopener noreferrer"}},[t._v("压缩解压文件"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://blog.csdn.net/ahxdyz/article/details/93534213",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell-压缩解压缩文件"),a("OutboundLink")],1)])]),t._v(" "),a("ul",[a("li",[t._v("PowerShell 5.0或更高版本(已预安装Windows 10和Windows Server 2016)")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Compress-Archive")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path 解压到目录路径 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("DestinationPath 压缩文件路径\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Expand-Archive")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path 解压到目录路径 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("DestinationPath 压缩文件路径 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Force:"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$Overwrite")]),t._v("\n")])])]),a("ul",[a("li",[t._v("需要.net 4.5以上")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add-Type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("assembly "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"system.io.compression.filesystem"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[io.compression.zipfile]")]),t._v("::ExtractToDirectory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("压缩文件路径"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 解压到目录路径"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[t._v("PowerShell 2.0以上")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" UnzipFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[string]")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sourceFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[string]")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$targetFolder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Test-Path")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$targetFolder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        mkdir "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$targetFolder")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$shellApp")]),t._v(" = "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("New-Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ComObject Shell"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Application\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$files")]),t._v(" = "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$shellApp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NameSpace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$souceFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Items"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# foreach ($item in $files) {")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#     $shell.Namespace($targetFolder).CopyHere($item)")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# }")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$shellApp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NameSpace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$targetFolder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CopyHere"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$files")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"事件计划任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事件计划任务"}},[t._v("#")]),t._v(" 事件计划任务")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.holoem.com/?p=1974",target:"_blank",rel:"noopener noreferrer"}},[t._v("Scheduled Tasks（计划任务）"),a("OutboundLink")],1)])]),t._v(" "),a("p",[a("strong",[t._v("使用Get-WinEvent")])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/powershell/module/microsoft.powershell.diagnostics/get-winevent",target:"_blank",rel:"noopener noreferrer"}},[t._v("Get-WinEvent"),a("OutboundLink")],1)])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Help")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-WinEvent")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-WinEvent")]),t._v(" @"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("logname="),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'system'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("MaxEvents 1\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 列出所有事件日志")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-WinEvent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ListLog "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# powershell管理员权限下获取安全事件日志")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-WinEvent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("FilterHashtable @"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("LogName="),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Security'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 过滤安全事件ID 4624")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-WinEvent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("FilterHashtable @"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("LogName="),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Security'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("ID="),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'4624'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查询今天的应用和系统日志，显示前2条")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-WinEvent")]),t._v(" @"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("logname="),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'system'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("starttime="),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[datetime]")]),t._v("::today "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("MaxEvents 2\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 根据ID查询事件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-WinEvent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("LogName Microsoft-Windows-PowerShell/Operational "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Where-Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ID "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-eq")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"4100"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-or")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ID "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-eq")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"4104"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查询指定时间内的事件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$StartTime")]),t._v("="),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Date")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Year  2020  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Month  3  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Day  1  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Hour  15  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Minute  30\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$EndTime")]),t._v("="),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Date")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Year  2020  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Month  3  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Day  15  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Hour  20  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Minute  00\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-WinEvent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("FilterHashtable @"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("LogName="),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'System'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("StartTime="),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$StartTime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("EndTime="),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$EndTime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[a("strong",[t._v("使用Get-EventLog")])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/powershell/module/microsoft.powershell.management/get-eventlog",target:"_blank",rel:"noopener noreferrer"}},[t._v("Get-EventLog"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.pstips.net/monitoring-eventlog.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell 监听事件日志"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.pstips.net/get-sleep-and-hibernation-times.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Powershell获取睡眠时间"),a("OutboundLink")],1)])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Help")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-EventLog")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-EventLog")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("LogName system "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Source user32\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 按 EventID 将事件进行分组")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-EventLog")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("LogName system "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Source user32 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("group")]),t._v(" EventID\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# fl 是 Format-List 的别名")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-EventLog")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("LogName system "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Source user32 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Newest 1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fl")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-EventLog")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("LogName system "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Source user32 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Select")]),t._v(" TimeGenerated"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Message\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-EventLog")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("LogName system "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Source user32 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Select")]),t._v(" TimeGenerated"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Message "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sort")]),t._v(" message\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-EventLog")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("LogName system "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Source user32 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Select")]),t._v(" TimeGenerated"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Message "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sort")]),t._v(" message "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ft")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Wrap\n")])])]),a("p",[a("strong",[t._v("定时任务")])]),t._v(" "),a("ul",[a("li",[t._v("查看支持的命令")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Command")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Module ScheduledTasks\n")])])]),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 此例子为每5分钟一次的定时任务，通过设置$step和$add可以实现延时执行任务。 ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" waitsec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$step")]),t._v("=300 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#设置间隔")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$add")]),t._v("=0 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#设置延时")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$t")]),t._v("="),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$step")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$t")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Hour*3600+"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$t")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Minute*60+"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$t")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Second"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$step")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$add")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n \n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("write-host")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"running...... please wait"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("waitsec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"S"')]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Start-Sleep")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("s "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("waitsec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 执行代码")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-date")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Start-Sleep")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("s "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("waitsec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用命令"}},[t._v("#")]),t._v(" 常用命令")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://blog.csdn.net/weixin_39775577/article/details/113628194",target:"_blank",rel:"noopener noreferrer"}},[t._v("Powershell基础入门及常见用法"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://stackoverflow.com/questions/9682024/how-to-do-what-head-tail-more-less-sed-do-in-powershell",target:"_blank",rel:"noopener noreferrer"}},[t._v("How to do what head, tail, more, less, sed do in Powershell?"),a("OutboundLink")],1)])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看别名对应的真实命令")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-alias")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看命名位置（类似 Linux Shell 的 which）")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-command")]),t._v(" xxx\ngcm xxx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过关键字查找 powershell 命令")]),t._v("\ngcm "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select-string")]),t._v(" <keyword>\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过关键字查找 powershell 命令和环境变量中的程序，比较慢")]),t._v("\ngcm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select-string")]),t._v(" <keyword>\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 类似 linux 的 find/ls 命令")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-childitem")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Recurse "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Include "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gci")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 清空终端的输出")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("clear-host")]),t._v("\nclear\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看文件内容")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-content")]),t._v(" xx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" more\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-content")]),t._v(" xx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("out-host")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("paging\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" xx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" xx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("py\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ReadCount是指每次发送给管道的文本行数，0代表全部")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Tail只返回指定结尾行数的文本")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# -wait 一直等待监听")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Content")]),t._v(" 文件路径 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ReadCount 0 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Tail 5 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Wait\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 编码转换 [System.Text.Encoding]::ASCII")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Content")]),t._v(" filename1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("encoding default "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set-content")]),t._v(" filename2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("encoding utf8\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("first 10 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# head")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("head 10\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("TotalCount 10 log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# also head")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ReadCount 5 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pipeline end!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# head")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("last 10  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# tail")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Tail 10 log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# also tail (since PSv3), also much faster than above option")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" more             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# or less if you have it installed")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-replace")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\d+'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'($0)'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sed Where-Object Foreach-Object Select-Object")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$num")]),t._v("=0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$num")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$num")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-gt")]),t._v(" 2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-and")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$num")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-lt")]),t._v(" 7"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$num")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v('"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sed")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gc")]),t._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$num")]),t._v("=0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$num")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$num")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v('"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cat -n")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 字符串搜索，不能对对象使用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 类似 linux 的 grep 命令")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select-string")]),t._v(" <pattern>\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gci")]),t._v(" env: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("out-string")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("stream "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select-string")]),t._v(" <pattern>  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 需要先使用 out-string 将对象转换成 string")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gci")]),t._v(" env: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("where-object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-like")]),t._v(" <pattern>"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 计算输出的行数/对象个数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gci")]),t._v(" env: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("measure-object")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gci")]),t._v(" env: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("measure")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这是缩写")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看所有进程")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-process")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" more\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" more  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 别名")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查找某进程（替代掉 tasklist）")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-process")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("name exp*"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("power*  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用正则查找进程")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-process")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select-string")]),t._v(" <pattern>  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 效果同上")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过 id 杀掉某进程（替代掉 taskkill）")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 也可以通过 -Name 用正则匹配进程")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("stop-process")]),t._v(" <pid>\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("kill")]),t._v(" <pid>  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 别名")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 网络相关命令")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 1. dns 相关(dns-client)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Clear-DnsClientCache")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 清除 dns 缓存（替换掉 `ipconfig /flushdns`）")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-DnsClientCache")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看 dns 缓存")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Resolve-DnsName")]),t._v(" baidu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 解析域名")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 2. TCP/IP 相关命令")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Command")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Net")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看所有 TCP/IP 相关的命令")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-NetIPAddress")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看 IP 地址")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-NetIPInterface")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看 IP 接口")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-NetRoute")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看路由表")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-NetNeighbor")]),t._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取链路层 MAC 地址缓存")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-NetTCPConnection")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看 TCP 连接")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("### 也可以对 TCP/IP 的 IP 地址、接口、路由表进行增删改")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("New-NetRoute")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Remove-NetNeighbor")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 清除 MAC 地址缓存")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 关机/重启")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("stop-computer")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("restart-computer")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# windows 计算 hash 值")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 功能等同于 linux 下的 sha256sum/sha1sum/sha512sum/md5sum")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-FileHash")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("path/to/file "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Algorithm SHA256\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-FileHash")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("path/to/file "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Algorithm SHA256  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Format-List")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 用 format 修改格式化效果")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# base64 编解码")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[Convert]")]),t._v("::ToBase64String"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[Text.Encoding]")]),t._v("::UTF8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetBytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxx"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# base64 编码")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[Text.Encoding]")]),t._v("::UTF8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetString"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[Convert]")]),t._v("::FromBase64String"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eHh4"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 解码")]),t._v("\n")])])]),a("h2",{attrs:{id:"随机字符串"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#随机字符串"}},[t._v("#")]),t._v(" 随机字符串")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("48..57")]),t._v("是数字0-9，powershell的范围操作符是"),a("code",[t._v("..")]),t._v("，"),a("code",[t._v("65..90")]),t._v("是大写字符A到Z，"),a("code",[t._v("97..122")]),t._v("是小写字母。\n如果需要获取多有的可打印字符（包括空格）的话，范围是"),a("code",[t._v("32..127")]),t._v("。")])]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("[char]")]),t._v("把对应数字转换成字符，例如 "),a("code",[t._v("[char](66)")]),t._v("就是B(大写字母B)，C语言使用的小括号来进行类型强制转换。")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果不指定-count参数，则前面的list有多少个字符")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# get-random就会获取多少个字符，只是顺序打乱了")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-join")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("48"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("57 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" 65"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("90 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" 97"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("122"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-random")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("count 6 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[char]")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输出19位数字字符串并在开头拼接x")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("13"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Random")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("count 19"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-join")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$null")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-join")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"X"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这里的0..1024相当于循环控制，每循环一次|后面的代码执行一次，")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 其中在数字字母中随机选一个字符 0..1024, like Perl, loop controller")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-join")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1024"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[char]")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[int]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("48"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("57 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" 65"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("90 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" 97"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("122"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Random")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-join")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[char[]]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("65"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("90+97"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("122"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Random")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Count 6"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add-Type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("AssemblyName System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Web"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[System.Web.Security.Membership]")]),t._v("::GeneratePassword"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("20"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-RandomString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("param")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[int]")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$length")]),t._v("=10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这里的[int]是类型指定")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[char[]]")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sourcedata")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$loop")]),t._v("=1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$loop")]),t._v(" –le "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$length")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$loop")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$TempPassword")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sourcedata")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("GET-RANDOM")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[char]")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$TempPassword")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-RandomString")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("length 14 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("sourcedata "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("48"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("127"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h2",{attrs:{id:"http服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http服务"}},[t._v("#")]),t._v(" HTTP服务")]),t._v(" "),a("div",{staticClass:"language-ps1 extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('start-job { \n    $p="d:\\"\n    #$p = Get-Location.path #获取当前用户的目录\n    $H=New-Object Net.HttpListener\n    $H.Prefixes.Add("http://+:8889/")\n    $H.Start()\n    While ($H.IsListening) {\n        $HC=$H.GetContext()\n        $HR=$HC.Response\n        $HR.Headers.Add("Content-Type","text/plain")\n\n        $file=Join-Path $p ($HC.Request).RawUrl\n        $text=[IO.File]::ReadAllText($file)\n        $text=[Text.Encoding]::UTF8.GetBytes($text)\n\n        $HR.ContentLength64 = $text.Length\n        $HR.OutputStream.Write($text,0,$text.Length)\n        $HR.Close()\n    }\n    $H.Stop()\n}\n')])])]),a("h2",{attrs:{id:"弹窗"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#弹窗"}},[t._v("#")]),t._v(" 弹窗")]),t._v(" "),a("div",{staticClass:"language-ps1 extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$xaml = @\"\n<Window xmlns='http://schemas.microsoft.com/winfx/2006/xaml/presentation'>\n <Border BorderThickness='20' BorderBrush='Yellow' CornerRadius='9' Background='Red'>\n  <StackPanel>\n   <Label FontSize='50' FontFamily='Stencil' Background='Red' Foreground='White' BorderThickness='0'>\n    System will be rebooted in 15 minutes!\n   </Label>\n   <Label HorizontalAlignment='Center' FontSize='15' FontFamily='Consolas' Background='Red' Foreground='White' BorderThickness='0'>\n    Worried about losing data? Talk to your friendly help desk representative and freely share your concerns!\n   </Label>\n  </StackPanel>\n </Border>\n</Window>\n\"@;\nAdd-Type -assemblyName PresentationFramework;\n$reader = [System.XML.XMLReader]::Create([System.IO.StringReader] $xaml);\n$window = [System.Windows.Markup.XAMLReader]::Load($reader);\n$Window.AllowsTransparency = $True;\n$window.SizeToContent = 'WidthAndHeight';\n$window.ResizeMode = 'NoResize';\n$Window.Opacity = .7;\n$window.Topmost = $true;\n$window.WindowStartupLocation = 'CenterScreen';\n$window.WindowStyle = 'None';\n$null = $window.Show();\nStart-Sleep -Seconds 10;\n$window.Close();\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);